

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>luxpy.color.cam.cam_02_X &mdash; LuxPy 1.3.7 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 

  
  <script src="../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../index.html" class="icon icon-home"> LuxPy
          

          
          </a>

          
            
            
              <div class="version">
                1.3.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../license.html">License: GPLv3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../required_packages.html">Imported (required) packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../luxpy_structure.html">Luxpy package structure</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">LuxPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
        
      <li>luxpy.color.cam.cam_02_X</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for luxpy.color.cam.cam_02_X</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">########################################################################</span>
<span class="c1"># &lt;LUXPY: a Python package for lighting and color science.&gt;</span>
<span class="c1"># Copyright (C) &lt;2017&gt;  &lt;Kevin A.G. Smet&gt; (ksmet1977 at gmail.com)</span>
<span class="c1">#</span>
<span class="c1"># This program is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU General Public License</span>
<span class="c1"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="c1">#########################################################################</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">cam_02_X: Module with CIECAM02-type color appearance models</span>
<span class="sd">===========================================================</span>

<span class="sd"> :_CAM_02_X_UNIQUE_HUE_DATA: database of unique hues with corresponding </span>
<span class="sd">                             Hue quadratures and eccentricity factors </span>
<span class="sd">                             for ciecam02, cam16, ciecam97s, cam15u)</span>

<span class="sd"> :_CAM_02_X_SURROUND_PARAMETERS: database of surround param. c, Nc, F and FLL </span>
<span class="sd">                                 for ciecam02, cam16, ciecam97s and cam15u.</span>

<span class="sd"> :_CAM_02_X_NAKA_RUSHTON_PARAMETERS: | database with parameters </span>
<span class="sd">                                       (n, sig, scaling and noise) </span>
<span class="sd">                                       for the Naka-Rushton function: </span>
<span class="sd">                                     | scaling * ((data**n) / ((data**n) + (sig**n))) + noise</span>

<span class="sd"> :_CAM_02_X_UCS_PARAMETERS: | database with parameters specifying the conversion </span>
<span class="sd">                              from ciecam02/cam16 to:</span>
<span class="sd">                            |    cam[x]ucs (uniform color space), </span>
<span class="sd">                            |    cam[x]lcd (large color diff.), </span>
<span class="sd">                            |    cam[x]scd (small color diff).</span>

<span class="sd"> :_CAM_02_X_DEFAULT_WHITE_POINT: Default internal reference white point (xyz)</span>

<span class="sd"> :_CAM_02_X_DEFAULT_TYPE: Default CAM type str specifier.</span>

<span class="sd"> : _CAM_02_X_DEFAULT_MCAT: Default MCAT specifier.</span>

<span class="sd"> :_CAM_02_X_DEFAULT_CONDITIONS: Default CAM model parameters for model </span>
<span class="sd">                                in cam._CAM_02_X_DEFAULT_TYPE</span>

<span class="sd"> :_CAM_02_X_AXES: dict with list[str,str,str] containing axis labels </span>
<span class="sd">                  of defined cspaces.</span>

<span class="sd"> :naka_rushton(): applies a Naka-Rushton function to the input</span>
<span class="sd"> </span>
<span class="sd"> :hue_angle(): calculates a positive hue angle</span>

<span class="sd"> :hue_quadrature(): calculates the Hue quadrature from the hue.</span>

<span class="sd"> :cam_structure_ciecam02_cam16(): | basic structure of ciecam02 and cam16 models.</span>
<span class="sd">                                  | Has &#39;forward&#39; (xyz --&gt; color attributes) </span>
<span class="sd">                                    and &#39;inverse&#39; (color attributes --&gt; xyz) modes.</span>

<span class="sd"> :ciecam02(): | calculates ciecam02 output </span>
<span class="sd">              | (wrapper for cam_structure_ciecam02_cam16 with specifics </span>
<span class="sd">                of ciecam02): </span>
<span class="sd">              | `N. Moroney, M. D. Fairchild, R. W. G. Hunt, C. Li, M. R. Luo, and T. Newman, </span>
<span class="sd">                “The CIECAM02 color appearance model,” </span>
<span class="sd">                IS&amp;T/SID Tenth Color Imaging Conference. p. 23, 2002. &lt;http://rit-mcsl.org/fairchild/PDFs/PRO19.pdf&gt;`_</span>

<span class="sd"> :cam16(): | calculates cam16 output </span>
<span class="sd">           | (wrapper for cam_structure_ciecam02_cam16 with specifics </span>
<span class="sd">             of cam16):  </span>
<span class="sd">           | `C. Li, Z. Li, Z. Wang, Y. Xu, M. R. Luo, G. Cui, M. Melgosa, M. H. Brill, and M. Pointer, </span>
<span class="sd">             “Comprehensive color solutions: CAM16, CAT16, and CAM16-UCS,” </span>
<span class="sd">             Color Res. Appl., p. n/a–n/a. &lt;http://onlinelibrary.wiley.com/doi/10.1002/col.22131/abstract&gt;`_</span>

<span class="sd"> :camucs_structure(): basic structure to go to ucs, lcd and scd color spaces </span>
<span class="sd">                      (forward + inverse available)</span>

<span class="sd"> :cam02ucs(): | calculates ucs (or lcd, scd) output based on ciecam02 </span>
<span class="sd">                (forward + inverse available)</span>
<span class="sd">              |  `M. R. Luo, G. Cui, and C. Li, </span>
<span class="sd">                 Uniform colour spaces based on CIECAM02 colour appearance model, </span>
<span class="sd">                 Color Research &amp; Application, 31(4), pp. 320–330, 2006.</span>
<span class="sd">                 &lt;http://onlinelibrary.wiley.com/doi/10.1002/col.20227/abstract&gt;`_</span>

<span class="sd"> :cam16ucs(): | calculates ucs (or lcd, scd) output based on cam16 </span>
<span class="sd">                (forward + inverse available)</span>
<span class="sd">              | `C. Li, Z. Li, Z. Wang, Y. Xu, M. R. Luo, G. Cui, M. Melgosa, M. H. Brill, and M. Pointer, </span>
<span class="sd">                “Comprehensive color solutions: CAM16, CAT16, and CAM16-UCS,” </span>
<span class="sd">                Color Res. Appl., p. n/a–n/a. &lt;http://onlinelibrary.wiley.com/doi/10.1002/col.22131/abstract&gt;`_</span>

<span class="sd"> :specific_wrappers_in_the_&#39;xyz_to_cspace()&#39; and &#39;cpsace_to_xyz()&#39; format:</span>
<span class="sd">      | &#39;xyz_to_jabM_ciecam02&#39;, &#39;jabM_ciecam02_to_xyz&#39;,</span>
<span class="sd">      | &#39;xyz_to_jabC_ciecam02&#39;, &#39;jabC_ciecam02_to_xyz&#39;,</span>
<span class="sd">      | &#39;xyz_to_jabM_cam16&#39;, &#39;jabM_cam16_to_xyz&#39;,</span>
<span class="sd">      | &#39;xyz_to_jabC_cam16&#39;, &#39;jabC_cam16_to_xyz&#39;,</span>
<span class="sd">      | &#39;xyz_to_jab_cam02ucs&#39;, &#39;jab_cam02ucs_to_xyz&#39;, </span>
<span class="sd">      | &#39;xyz_to_jab_cam02lcd&#39;, &#39;jab_cam02lcd_to_xyz&#39;,</span>
<span class="sd">      | &#39;xyz_to_jab_cam02scd&#39;, &#39;jab_cam02scd_to_xyz&#39;, </span>
<span class="sd">      | &#39;xyz_to_jab_cam16ucs&#39;, &#39;jab_cam16ucs_to_xyz&#39;,</span>
<span class="sd">      | &#39;xyz_to_jab_cam16lcd&#39;, &#39;jab_cam16lcd_to_xyz&#39;,</span>
<span class="sd">      | &#39;xyz_to_jab_cam16scd&#39;, &#39;jab_cam16scd_to_xyz&#39;</span>


<span class="sd">.. codeauthor:: Kevin A.G. Smet (ksmet1977 at gmail.com)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">luxpy</span> <span class="k">import</span> <span class="n">np</span><span class="p">,</span> <span class="n">math</span><span class="p">,</span> <span class="n">cat</span><span class="p">,</span> <span class="n">_CIEOBS</span><span class="p">,</span> <span class="n">_CIE_ILLUMINANTS</span><span class="p">,</span> <span class="n">np2d</span><span class="p">,</span> <span class="n">np2dT</span><span class="p">,</span> <span class="n">np3d</span><span class="p">,</span> <span class="n">put_args_in_db</span><span class="p">,</span> <span class="n">spd_to_xyz</span><span class="p">,</span> <span class="n">asplit</span><span class="p">,</span> <span class="n">ajoin</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;_CAM_02_X_AXES&#39;</span><span class="p">,</span> <span class="s1">&#39;_CAM_02_X_UNIQUE_HUE_DATA&#39;</span><span class="p">,</span><span class="s1">&#39;_CAM_02_X_SURROUND_PARAMETERS&#39;</span><span class="p">,</span><span class="s1">&#39;_CAM_02_X_NAKA_RUSHTON_PARAMETERS&#39;</span><span class="p">,</span><span class="s1">&#39;_CAM_02_X_UCS_PARAMETERS&#39;</span><span class="p">]</span>
<span class="n">__all__</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;_CAM_02_X_DEFAULT_TYPE&#39;</span><span class="p">,</span><span class="s1">&#39;_CAM_02_X_DEFAULT_WHITE_POINT&#39;</span><span class="p">,</span><span class="s1">&#39;_CAM_02_X_DEFAULT_MCAT&#39;</span><span class="p">,</span> <span class="s1">&#39;_CAM_02_X_DEFAULT_CONDITIONS&#39;</span><span class="p">]</span>
<span class="n">__all__</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;hue_angle&#39;</span><span class="p">,</span> <span class="s1">&#39;hue_quadrature&#39;</span><span class="p">,</span><span class="s1">&#39;naka_rushton&#39;</span><span class="p">,</span>
            <span class="s1">&#39;cam_structure_ciecam02_cam16&#39;</span><span class="p">,</span><span class="s1">&#39;camucs_structure&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ciecam02&#39;</span><span class="p">,</span><span class="s1">&#39;cam16&#39;</span><span class="p">,</span><span class="s1">&#39;cam02ucs&#39;</span><span class="p">,</span><span class="s1">&#39;cam16ucs&#39;</span><span class="p">]</span>

<span class="n">__all__</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;xyz_to_jabM_ciecam02&#39;</span><span class="p">,</span> <span class="s1">&#39;jabM_ciecam02_to_xyz&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;xyz_to_jabC_ciecam02&#39;</span><span class="p">,</span> <span class="s1">&#39;jabC_ciecam02_to_xyz&#39;</span><span class="p">,</span>
            <span class="s1">&#39;xyz_to_jabM_cam16&#39;</span><span class="p">,</span> <span class="s1">&#39;jabM_cam16_to_xyz&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;xyz_to_jabC_cam16&#39;</span><span class="p">,</span> <span class="s1">&#39;jabC_cam16_to_xyz&#39;</span><span class="p">,</span>
            <span class="s1">&#39;xyz_to_jab_cam02ucs&#39;</span><span class="p">,</span> <span class="s1">&#39;jab_cam02ucs_to_xyz&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;xyz_to_jab_cam02lcd&#39;</span><span class="p">,</span> <span class="s1">&#39;jab_cam02lcd_to_xyz&#39;</span><span class="p">,</span>
            <span class="s1">&#39;xyz_to_jab_cam02scd&#39;</span><span class="p">,</span> <span class="s1">&#39;jab_cam02scd_to_xyz&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;xyz_to_jab_cam16ucs&#39;</span><span class="p">,</span> <span class="s1">&#39;jab_cam16ucs_to_xyz&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;xyz_to_jab_cam16lcd&#39;</span><span class="p">,</span> <span class="s1">&#39;jab_cam16lcd_to_xyz&#39;</span><span class="p">,</span>
            <span class="s1">&#39;xyz_to_jab_cam16scd&#39;</span><span class="p">,</span> <span class="s1">&#39;jab_cam16scd_to_xyz&#39;</span><span class="p">,</span> 
            <span class="p">]</span>


<span class="n">_CAM_02_X_AXES</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;jabM_ciecam02&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;J (ciecam02)&quot;</span><span class="p">,</span> <span class="s2">&quot;aM (ciecam02)&quot;</span><span class="p">,</span> <span class="s2">&quot;bM (ciecam02)&quot;</span><span class="p">]}</span>
<span class="n">_CAM_02_X_AXES</span><span class="p">[</span><span class="s1">&#39;jabC_ciecam02&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;J (ciecam02)&quot;</span><span class="p">,</span> <span class="s2">&quot;aC (ciecam02)&quot;</span><span class="p">,</span> <span class="s2">&quot;bC (ciecam02)&quot;</span><span class="p">]</span> 
<span class="n">_CAM_02_X_AXES</span><span class="p">[</span><span class="s1">&#39;jabM_cam16&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;J (cam16)&quot;</span><span class="p">,</span> <span class="s2">&quot;aM (cam16)&quot;</span><span class="p">,</span> <span class="s2">&quot;bM (cam16)&quot;</span><span class="p">]</span>
<span class="n">_CAM_02_X_AXES</span><span class="p">[</span><span class="s1">&#39;jabC_cam16&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;J (cam16)&quot;</span><span class="p">,</span> <span class="s2">&quot;aC (cam16)&quot;</span><span class="p">,</span> <span class="s2">&quot;bC (cam16)&quot;</span><span class="p">]</span> 
<span class="n">_CAM_02_X_AXES</span><span class="p">[</span><span class="s1">&#39;jab_cam02ucs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;J&#39; (cam02ucs)&quot;</span><span class="p">,</span> <span class="s2">&quot;a&#39; (cam02ucs)&quot;</span><span class="p">,</span> <span class="s2">&quot;b&#39; (cam02ucs)&quot;</span><span class="p">]</span> 
<span class="n">_CAM_02_X_AXES</span><span class="p">[</span><span class="s1">&#39;jab_cam02lcd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;J&#39; (cam02lcd)&quot;</span><span class="p">,</span> <span class="s2">&quot;a&#39; (cam02lcd)&quot;</span><span class="p">,</span> <span class="s2">&quot;b&#39; (cam02lcd)&quot;</span><span class="p">]</span> 
<span class="n">_CAM_02_X_AXES</span><span class="p">[</span><span class="s1">&#39;jab_cam02scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;J&#39; (cam02scd)&quot;</span><span class="p">,</span> <span class="s2">&quot;a&#39; (cam02scd)&quot;</span><span class="p">,</span> <span class="s2">&quot;b&#39; (cam02scd)&quot;</span><span class="p">]</span> 

<span class="n">_CAM_02_X_UNIQUE_HUE_DATA</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;parameters&#39;</span><span class="p">:</span> <span class="s1">&#39;hues i hi ei Hi&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()}</span>
<span class="n">_CAM_02_X_UNIQUE_HUE_DATA</span><span class="p">[</span><span class="s1">&#39;models&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ciecam97s ciecam02 cam16&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">_CAM_02_X_UNIQUE_HUE_DATA</span><span class="p">[</span><span class="s1">&#39;ciecam97s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;hues&#39;</span><span class="p">:</span> <span class="s1">&#39;red yellow green blue red&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">5.0</span><span class="p">),</span> <span class="s1">&#39;hi&#39;</span><span class="p">:[</span><span class="mf">20.14</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">,</span> <span class="mf">164.25</span><span class="p">,</span><span class="mf">237.53</span><span class="p">,</span><span class="mf">380.14</span><span class="p">],</span><span class="s1">&#39;ei&#39;</span><span class="p">:[</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">0.8</span><span class="p">],</span><span class="s1">&#39;Hi&#39;</span><span class="p">:[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">100.0</span><span class="p">,</span><span class="mf">200.0</span><span class="p">,</span><span class="mf">300.0</span><span class="p">,</span><span class="mf">400.0</span><span class="p">]}</span>
<span class="n">_CAM_02_X_UNIQUE_HUE_DATA</span><span class="p">[</span><span class="s1">&#39;ciecam02&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_CAM_02_X_UNIQUE_HUE_DATA</span><span class="p">[</span><span class="s1">&#39;ciecam97s&#39;</span><span class="p">]</span>
<span class="n">_CAM_02_X_UNIQUE_HUE_DATA</span><span class="p">[</span><span class="s1">&#39;cam16&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;hues&#39;</span><span class="p">:</span> <span class="s1">&#39;red yellow green blue red&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">5.0</span><span class="p">),</span> <span class="s1">&#39;hi&#39;</span><span class="p">:[</span><span class="mf">20.14</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">,</span> <span class="mf">164.25</span><span class="p">,</span><span class="mf">237.53</span><span class="p">,</span><span class="mf">380.14</span><span class="p">],</span><span class="s1">&#39;ei&#39;</span><span class="p">:[</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">0.8</span><span class="p">],</span><span class="s1">&#39;Hi&#39;</span><span class="p">:[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">100.0</span><span class="p">,</span><span class="mf">200.0</span><span class="p">,</span><span class="mf">300.0</span><span class="p">,</span><span class="mf">400.0</span><span class="p">]}</span>
<span class="n">_UNIQUE_HUE_DATA</span> <span class="o">=</span> <span class="n">_CAM_02_X_UNIQUE_HUE_DATA</span>

<span class="n">_CAM_02_X_SURROUND_PARAMETERS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;parameters&#39;</span><span class="p">:</span> <span class="s1">&#39;c Nc F FLL&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()}</span>
<span class="n">_CAM_02_X_SURROUND_PARAMETERS</span><span class="p">[</span><span class="s1">&#39;models&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ciecam97s ciecam02 cam16&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">_CAM_02_X_SURROUND_PARAMETERS</span><span class="p">[</span><span class="s1">&#39;ciecam97s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;surrounds&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;avg&#39;</span><span class="p">,</span> <span class="s1">&#39;avg,stim&gt;4°&#39;</span><span class="p">,</span><span class="s1">&#39;dim&#39;</span><span class="p">,</span> <span class="s1">&#39;dark&#39;</span><span class="p">,</span><span class="s1">&#39;cutsheet&#39;</span><span class="p">],</span> <span class="s1">&#39;avg&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="mf">0.69</span><span class="p">,</span> <span class="s1">&#39;Nc&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span><span class="s1">&#39;FLL&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">},</span> <span class="s1">&#39;avg,stim&gt;4°&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="mf">0.69</span><span class="p">,</span> <span class="s1">&#39;Nc&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span><span class="s1">&#39;FLL&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">},</span> <span class="s1">&#39;dim&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="mf">0.59</span><span class="p">,</span> <span class="s1">&#39;Nc&#39;</span><span class="p">:</span><span class="mf">1.1</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span><span class="mf">0.9</span><span class="p">,</span><span class="s1">&#39;FLL&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">}</span> <span class="p">,</span><span class="s1">&#39;dark&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="mf">0.525</span><span class="p">,</span> <span class="s1">&#39;Nc&#39;</span><span class="p">:</span><span class="mf">0.8</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span><span class="mf">0.9</span><span class="p">,</span><span class="s1">&#39;FLL&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">},</span><span class="s1">&#39;cutsheet&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="mf">0.41</span><span class="p">,</span> <span class="s1">&#39;Nc&#39;</span><span class="p">:</span><span class="mf">0.8</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span><span class="mf">0.9</span><span class="p">,</span><span class="s1">&#39;FLL&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">}}</span>
<span class="n">_CAM_02_X_SURROUND_PARAMETERS</span><span class="p">[</span><span class="s1">&#39;ciecam02&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="p">{</span><span class="s1">&#39;surrounds&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;avg&#39;</span><span class="p">,</span> <span class="s1">&#39;dim&#39;</span><span class="p">,</span> <span class="s1">&#39;dark&#39;</span><span class="p">],</span> <span class="s1">&#39;avg&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="mf">0.69</span><span class="p">,</span> <span class="s1">&#39;Nc&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span><span class="s1">&#39;FLL&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">},</span> <span class="s1">&#39;dim&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="mf">0.59</span><span class="p">,</span> <span class="s1">&#39;Nc&#39;</span><span class="p">:</span><span class="mf">0.9</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span><span class="mf">0.9</span><span class="p">,</span><span class="s1">&#39;FLL&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">}</span> <span class="p">,</span><span class="s1">&#39;dark&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="mf">0.525</span><span class="p">,</span> <span class="s1">&#39;Nc&#39;</span><span class="p">:</span><span class="mf">0.8</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span><span class="mf">0.8</span><span class="p">,</span><span class="s1">&#39;FLL&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">}}</span>
<span class="n">_CAM_02_X_SURROUND_PARAMETERS</span><span class="p">[</span><span class="s1">&#39;cam16&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="p">{</span><span class="s1">&#39;surrounds&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;avg&#39;</span><span class="p">,</span> <span class="s1">&#39;dim&#39;</span><span class="p">,</span> <span class="s1">&#39;dark&#39;</span><span class="p">],</span> <span class="s1">&#39;avg&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="mf">0.69</span><span class="p">,</span> <span class="s1">&#39;Nc&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span><span class="s1">&#39;FLL&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">},</span> <span class="s1">&#39;dim&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="mf">0.59</span><span class="p">,</span> <span class="s1">&#39;Nc&#39;</span><span class="p">:</span><span class="mf">0.9</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span><span class="mf">0.9</span><span class="p">,</span><span class="s1">&#39;FLL&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">}</span> <span class="p">,</span><span class="s1">&#39;dark&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="mf">0.525</span><span class="p">,</span> <span class="s1">&#39;Nc&#39;</span><span class="p">:</span><span class="mf">0.8</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span><span class="mf">0.8</span><span class="p">,</span><span class="s1">&#39;FLL&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">}}</span>

<span class="n">_CAM_02_X_NAKA_RUSHTON_PARAMETERS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;parameters&#39;</span><span class="p">:</span> <span class="s1">&#39;n sig scaling noise&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()}</span>
<span class="n">_CAM_02_X_NAKA_RUSHTON_PARAMETERS</span><span class="p">[</span><span class="s1">&#39;models&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ciecam02 ciecam97s cam15u cam16&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">_CAM_02_X_NAKA_RUSHTON_PARAMETERS</span><span class="p">[</span><span class="s1">&#39;ciecam02&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="mf">0.42</span><span class="p">,</span> <span class="s1">&#39;sig&#39;</span><span class="p">:</span> <span class="mf">27.13</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mf">0.42</span><span class="p">),</span> <span class="s1">&#39;scaling&#39;</span><span class="p">:</span> <span class="mf">400.0</span><span class="p">,</span> <span class="s1">&#39;noise&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">}</span>
<span class="n">_CAM_02_X_NAKA_RUSHTON_PARAMETERS</span><span class="p">[</span><span class="s1">&#39;ciecam97s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="mf">0.73</span><span class="p">,</span> <span class="s1">&#39;sig&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mf">0.73</span><span class="p">),</span> <span class="s1">&#39;scaling&#39;</span><span class="p">:</span> <span class="mf">40.0</span><span class="p">,</span> <span class="s1">&#39;noise&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>
<span class="n">_CAM_02_X_NAKA_RUSHTON_PARAMETERS</span><span class="p">[</span><span class="s1">&#39;cam16&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="mf">0.42</span><span class="p">,</span> <span class="s1">&#39;sig&#39;</span><span class="p">:</span> <span class="mf">27.13</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mf">0.42</span><span class="p">),</span> <span class="s1">&#39;scaling&#39;</span><span class="p">:</span> <span class="mf">400.0</span><span class="p">,</span> <span class="s1">&#39;noise&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">}</span>
<span class="n">_NAKA_RUSHTON_PARAMETERS</span> <span class="o">=</span> <span class="n">_CAM_02_X_NAKA_RUSHTON_PARAMETERS</span>

<span class="n">_CAM_02_X_UCS_PARAMETERS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ciecam02&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;KL&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;c1&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;c2&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">},</span><span class="s1">&#39;ucs&#39;</span><span class="p">:{</span><span class="s1">&#39;KL&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;c1&#39;</span><span class="p">:</span><span class="mf">0.007</span><span class="p">,</span><span class="s1">&#39;c2&#39;</span><span class="p">:</span><span class="mf">0.0228</span><span class="p">},</span><span class="s1">&#39;lcd&#39;</span><span class="p">:{</span><span class="s1">&#39;KL&#39;</span><span class="p">:</span> <span class="mf">0.77</span><span class="p">,</span> <span class="s1">&#39;c1&#39;</span><span class="p">:</span><span class="mf">0.007</span><span class="p">,</span><span class="s1">&#39;c2&#39;</span><span class="p">:</span><span class="mf">0.0053</span><span class="p">},</span> <span class="s1">&#39;scd&#39;</span><span class="p">:{</span><span class="s1">&#39;KL&#39;</span><span class="p">:</span> <span class="mf">1.24</span><span class="p">,</span> <span class="s1">&#39;c1&#39;</span><span class="p">:</span><span class="mf">0.007</span><span class="p">,</span><span class="s1">&#39;c2&#39;</span><span class="p">:</span><span class="mf">0.0363</span><span class="p">}}}</span>
<span class="n">_CAM_02_X_UCS_PARAMETERS</span><span class="p">[</span><span class="s1">&#39;cam16&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;KL&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;c1&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;c2&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">},</span><span class="s1">&#39;ucs&#39;</span><span class="p">:{</span><span class="s1">&#39;KL&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;c1&#39;</span><span class="p">:</span><span class="mf">0.007</span><span class="p">,</span><span class="s1">&#39;c2&#39;</span><span class="p">:</span><span class="mf">0.0228</span><span class="p">},</span><span class="s1">&#39;lcd&#39;</span><span class="p">:{</span><span class="s1">&#39;KL&#39;</span><span class="p">:</span> <span class="mf">0.77</span><span class="p">,</span> <span class="s1">&#39;c1&#39;</span><span class="p">:</span><span class="mf">0.007</span><span class="p">,</span><span class="s1">&#39;c2&#39;</span><span class="p">:</span><span class="mf">0.0053</span><span class="p">},</span> <span class="s1">&#39;scd&#39;</span><span class="p">:{</span><span class="s1">&#39;KL&#39;</span><span class="p">:</span> <span class="mf">1.24</span><span class="p">,</span> <span class="s1">&#39;c1&#39;</span><span class="p">:</span><span class="mf">0.007</span><span class="p">,</span><span class="s1">&#39;c2&#39;</span><span class="p">:</span><span class="mf">0.0363</span><span class="p">}}</span>

<span class="n">_CAM_02_X_DEFAULT_TYPE</span> <span class="o">=</span> <span class="s1">&#39;ciecam02&#39;</span>
<span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span> <span class="o">=</span> <span class="n">np2d</span><span class="p">([</span><span class="mf">100.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">])</span> <span class="c1"># ill. E white point</span>
<span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;La&#39;</span><span class="p">:</span> <span class="mf">100.0</span><span class="p">,</span> <span class="s1">&#39;Yb&#39;</span><span class="p">:</span> <span class="mf">20.0</span><span class="p">,</span> <span class="s1">&#39;surround&#39;</span><span class="p">:</span> <span class="s1">&#39;avg&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;Dtype&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">}</span>
<span class="n">_CAM_02_X_DEFAULT_MCAT</span> <span class="o">=</span> <span class="s1">&#39;cat02&#39;</span>

<div class="viewcode-block" id="naka_rushton"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.naka_rushton">[docs]</a><span class="k">def</span> <span class="nf">naka_rushton</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sig</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mf">0.73</span><span class="p">,</span> <span class="n">scaling</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">noise</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">cam</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;forward&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply a Naka-Rushton response compression (n) and an adaptive shift (sig).</span>
<span class="sd">    </span>
<span class="sd">    | NK(x) = scaling * ((x**n) / ((x**n) + (sig**n))) + noise</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        :data:</span>
<span class="sd">            | float or ndarray</span>
<span class="sd">        :sig: </span>
<span class="sd">            | 2.0, optional</span>
<span class="sd">            | Semi-saturation constant. Value for which NK(:data:) is 1/2</span>
<span class="sd">        :n: </span>
<span class="sd">            | 0.73, optional</span>
<span class="sd">            | Compression power.</span>
<span class="sd">        :scaling:</span>
<span class="sd">            | 1.0, optional</span>
<span class="sd">            | Maximum value of NK-function.</span>
<span class="sd">        :noise:</span>
<span class="sd">            | 0.0, optional</span>
<span class="sd">            | Cone excitation noise.</span>
<span class="sd">        :cam: </span>
<span class="sd">            | None or str, optional</span>
<span class="sd">            | Use NK parameters values specific to the color appearance model.</span>
<span class="sd">            | See .cam._NAKA_RUSHTON_PARAMETERS[&#39;models&#39;] for supported types.</span>
<span class="sd">        :direction:</span>
<span class="sd">            | &#39;forward&#39; or &#39;inverse&#39;, optional</span>
<span class="sd">            | Perform either NK(x) or NK(x)**(-1).</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        :returns: </span>
<span class="sd">            | float or ndarray with NK-(de)compressed input :x:        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">cam</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="c1">#override input</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">_NAKA_RUSHTON_PARAMETERS</span><span class="p">[</span><span class="n">cam</span><span class="p">][</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>
        <span class="n">sig</span> <span class="o">=</span> <span class="n">_NAKA_RUSHTON_PARAMETERS</span><span class="p">[</span><span class="n">cam</span><span class="p">][</span><span class="s1">&#39;sig&#39;</span><span class="p">]</span>
        <span class="n">scaling</span> <span class="o">=</span> <span class="n">_NAKA_RUSHTON_PARAMETERS</span><span class="p">[</span><span class="n">cam</span><span class="p">][</span><span class="s1">&#39;scaling&#39;</span><span class="p">]</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="n">_NAKA_RUSHTON_PARAMETERS</span><span class="p">[</span><span class="n">cam</span><span class="p">][</span><span class="s1">&#39;noise&#39;</span><span class="p">]</span>
        
    <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;forward&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">scaling</span> <span class="o">*</span> <span class="p">((</span><span class="n">data</span><span class="o">**</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">data</span><span class="o">**</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">sig</span><span class="o">**</span><span class="n">n</span><span class="p">)))</span> <span class="o">+</span> <span class="n">noise</span>
    <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span><span class="s1">&#39;inverse&#39;</span><span class="p">:</span>
        <span class="n">Ip</span> <span class="o">=</span>  <span class="n">sig</span><span class="o">*</span><span class="p">(((</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="o">-</span><span class="n">noise</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">scaling</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="o">-</span><span class="n">noise</span><span class="p">))))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">Ip</span><span class="p">):</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span> <span class="o">&lt;</span> <span class="n">noise</span><span class="p">)</span>
            <span class="n">Ip</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Ip</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">data</span> <span class="o">&lt;</span> <span class="n">noise</span><span class="p">:</span>
                <span class="n">Ip</span> <span class="o">=</span> <span class="o">-</span><span class="n">Ip</span>
        <span class="k">return</span> <span class="n">Ip</span></div>

<div class="viewcode-block" id="hue_angle"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.hue_angle">[docs]</a><span class="k">def</span> <span class="nf">hue_angle</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span> <span class="n">htype</span> <span class="o">=</span> <span class="s1">&#39;deg&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate positive hue angle (0°-360° or 0 - 2*pi rad.) </span>
<span class="sd">    from opponent signals a and b.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        :a: </span>
<span class="sd">            | ndarray of a-coordinates</span>
<span class="sd">        :b: </span>
<span class="sd">            | ndarray of b-coordinates</span>
<span class="sd">        :htype: </span>
<span class="sd">            | &#39;deg&#39; or &#39;rad&#39;, optional</span>
<span class="sd">            |   - &#39;deg&#39;: hue angle between 0° and 360°</span>
<span class="sd">            |   - &#39;rad&#39;: hue angle between 0 and 2pi radians</span>
<span class="sd">    Returns:</span>
<span class="sd">        :returns:</span>
<span class="sd">            | ndarray of positive hue angles.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">positive_arctan</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span> <span class="n">htype</span> <span class="o">=</span> <span class="n">htype</span><span class="p">)</span></div>

<div class="viewcode-block" id="hue_quadrature"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.hue_quadrature">[docs]</a><span class="k">def</span> <span class="nf">hue_quadrature</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">unique_hue_data</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get hue quadrature H from h.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        :h: </span>
<span class="sd">            | float or list[float] or ndarray with hue data in degrees (!).</span>
<span class="sd">        :unique_hue data:</span>
<span class="sd">            | None or str or dict, optional</span>
<span class="sd">            |   - None: H = h.</span>
<span class="sd">            |   - str: CAM specifier that gets parameters from .cam._UNIQUE_HUE_DATA</span>
<span class="sd">            |          (For supported models, see .cam._UNIQUE_HUE_DATA[&#39;models&#39;])</span>
<span class="sd">            |   - dict: user specified unique hue data </span>
<span class="sd">            |          (see luxpy.cam._UNIQUE_HUE_DATA for expected structure)</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        :H: </span>
<span class="sd">            | float or list[float] or ndarray of Hue quadrature value(s).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">unique_hue_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">h</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">unique_hue_data</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
        <span class="n">unique_hue_data</span> <span class="o">=</span> <span class="n">_UNIQUE_HUE_DATA</span><span class="p">[</span><span class="n">unique_hue_data</span><span class="p">]</span>
    
    <span class="n">squeezed</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">h</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">squeezed</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="n">hi</span> <span class="o">=</span> <span class="n">unique_hue_data</span><span class="p">[</span><span class="s1">&#39;hi&#39;</span><span class="p">]</span>
    <span class="n">Hi</span> <span class="o">=</span> <span class="n">unique_hue_data</span><span class="p">[</span><span class="s1">&#39;Hi&#39;</span><span class="p">]</span>
    <span class="n">ei</span> <span class="o">=</span> <span class="n">unique_hue_data</span><span class="p">[</span><span class="s1">&#39;ei&#39;</span><span class="p">]</span>
    <span class="n">h</span><span class="p">[</span><span class="n">h</span><span class="o">&lt;</span><span class="n">hi</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">h</span><span class="o">&lt;</span><span class="n">hi</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="mf">360.0</span>
    <span class="n">h_hi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">h</span><span class="p">),</span><span class="n">repeats</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">hi</span><span class="p">),</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">hi_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">hi</span><span class="p">),</span><span class="n">repeats</span><span class="o">=</span><span class="n">h</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">h_hi</span><span class="o">-</span><span class="n">hi_h</span>
    <span class="n">d</span><span class="p">[</span><span class="n">d</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1000.0</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">p</span><span class="p">[</span><span class="n">p</span><span class="o">==</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hi</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># make sure last unique hue data is not selected</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Hi</span><span class="p">[</span><span class="n">pi</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mf">100.0</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">hi</span><span class="p">[</span><span class="n">pi</span><span class="p">])</span><span class="o">/</span><span class="n">ei</span><span class="p">[</span><span class="n">pi</span><span class="p">])</span><span class="o">/</span><span class="p">((</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">hi</span><span class="p">[</span><span class="n">pi</span><span class="p">])</span><span class="o">/</span><span class="n">ei</span><span class="p">[</span><span class="n">pi</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">hi</span><span class="p">[</span><span class="n">pi</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">ei</span><span class="p">[</span><span class="n">pi</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">pi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">)])</span>
    <span class="k">if</span> <span class="n">squeezed</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">H</span></div>


<span class="k">def</span> <span class="nf">cam_structure_ciecam02_cam16</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> \
                                 <span class="n">camtype</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_TYPE</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>\
                                 <span class="n">Yw</span> <span class="o">=</span> <span class="n">np2d</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span>\
                                 <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;forward&#39;</span><span class="p">,</span> <span class="n">outin</span> <span class="o">=</span> <span class="s1">&#39;J,aM,bM&#39;</span><span class="p">,</span> \
                                 <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert between XYZ tristsimulus values and </span>
<span class="sd">    ciecam02 /cam16 color appearance correlates.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        :data: </span>
<span class="sd">            | ndarray with input tristimulus values or </span>
<span class="sd">              input color appearance correlates</span>
<span class="sd">            | Can be of shape: (N [, xM], x 3), whereby </span>
<span class="sd">              N refers to samples, M to light sources.</span>
<span class="sd">        :xyzw:</span>
<span class="sd">            | _CAM_02_X_DEFAULT_WHITE_POINT or ndarray with tristimulus values</span>
<span class="sd">              of white point(s), optional</span>
<span class="sd">            | Can be multiple by specifying a Mx3 ndarray, instead of 1x3.</span>
<span class="sd">        :Yw: </span>
<span class="sd">            | luxpy.np2d(100), optional</span>
<span class="sd">            | Luminance factor of white point.</span>
<span class="sd">            | Is normally 100 for perfect white diffuser, </span>
<span class="sd">              is &lt; 100 for e.g. paper as white point.         </span>
<span class="sd">        :camtype: </span>
<span class="sd">            | luxpy.cam._CAM_02_X_DEFAULT_TYPE, optional</span>
<span class="sd">            | Str specifier for CAM type to use, options: &#39;ciecam02&#39; or &#39;cam16&#39;.</span>
<span class="sd">        :mcat:</span>
<span class="sd">            | None or str or ndarray, optional</span>
<span class="sd">            | Specifies CAT sensor space.</span>
<span class="sd">            |   - None defaults to the one native to the camtype </span>
<span class="sd">            |      (others e.g. &#39;cat02-bs&#39;, &#39;cat02-jiang&#39;,</span>
<span class="sd">            |      all trying to correct gamut problems of original cat02 matrix)</span>
<span class="sd">            |   - str: see see luxpy.cat._MCATS.keys() for options </span>
<span class="sd">            |    (details on type, ?luxpy.cat)</span>
<span class="sd">            |   - ndarray: matrix with sensor primaries</span>
<span class="sd">        :condition:</span>
<span class="sd">            | luxpy.cam._CAM_02_X_DEFAULT_CONDITIONS, optional</span>
<span class="sd">            | Dict with condition parameters, D, La, surround ([c,Nc,F]), Yb</span>
<span class="sd">            | Can be user defined, but dict must have same structure.</span>
<span class="sd">        :direction:</span>
<span class="sd">            | &#39;forward&#39; or &#39;inverse&#39;, optional</span>
<span class="sd">            |   -&#39;forward&#39;: xyz -&gt; ciecam02 / cam16</span>
<span class="sd">            |   -&#39;inverse&#39;: ciecam02 / cam16 -&gt; xyz </span>
<span class="sd">            |    (input data must be:</span>
<span class="sd">            |         (J or Q, aM, bM) or </span>
<span class="sd">            |         (J or Q, aC,bC) or </span>
<span class="sd">            |         (J or Q, aS, bS) !!)</span>
<span class="sd">        :outin: </span>
<span class="sd">            | &#39;J,aM,bM&#39; or str, optional</span>
<span class="sd">            | Str specifying the type of </span>
<span class="sd">            |   input (:direction: == &#39;inverse&#39;) and </span>
<span class="sd">            |   output (:direction: == &#39;forward&#39;)</span>
<span class="sd">        :yellowbluepurplecorrect:</span>
<span class="sd">            | True or False, optional</span>
<span class="sd">            | Correct for yellow-blue and purple problems in ciecam02 </span>
<span class="sd">              (Is not used in cam16 because cat16 solves issues)</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        :returns: </span>
<span class="sd">            | ndarray with color appearance correlates (:direction: == &#39;forward&#39;)</span>
<span class="sd">            |   or </span>
<span class="sd">            | XYZ tristimulus values (:direction: == &#39;inverse&#39;)</span>
<span class="sd">    </span>
<span class="sd">    References:</span>
<span class="sd">        1. `N. Moroney, M. D. Fairchild, R. W. G. Hunt, C. Li, M. R. Luo, and T. Newman, (2002), </span>
<span class="sd">        &quot;The CIECAM02 color appearance model,” </span>
<span class="sd">        IS&amp;T/SID Tenth Color Imaging Conference. p. 23, 2002.</span>
<span class="sd">        &lt;http://rit-mcsl.org/fairchild/PDFs/PRO19.pdf&gt;`_</span>
<span class="sd">        2. `C. Li, Z. Li, Z. Wang, Y. Xu, M. R. Luo, G. Cui, M. Melgosa, M. H. Brill, and M. Pointer, (2017), </span>
<span class="sd">        “Comprehensive color solutions: CAM16, CAT16, and CAM16-UCS,” </span>
<span class="sd">        Color Res. Appl., p. n/a–n/a.</span>
<span class="sd">        &lt;http://onlinelibrary.wiley.com/doi/10.1002/col.22131/abstract&gt;`_</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">outin</span> <span class="o">=</span> <span class="n">outin</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
      
    <span class="c1">#initialize data, xyzw, conditions and camout:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np2d</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">data_original_shape</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>

    <span class="c1">#prepare input parameters related to viewing conditions.</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span> <span class="c1"># add dim to avoid looping</span>
    
    <span class="k">if</span> <span class="n">xyzw</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xyzw</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">xyzw</span> <span class="o">=</span> <span class="p">(</span><span class="n">xyzw</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))[</span><span class="kc">None</span><span class="p">]</span> <span class="c1">#make xyzw same looping size</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">xyzw</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span><span class="nb">dict</span><span class="p">):</span>
        <span class="n">conditions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1">#create condition dict for each xyzw</span>

    <span class="n">Yw</span> <span class="o">=</span> <span class="n">np2d</span><span class="p">(</span><span class="n">Yw</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">Yw</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">Yw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">Yw</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">dshape</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">dshape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">outin</span><span class="p">)</span> <span class="c1"># requested number of correlates</span>
    <span class="n">camout</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">dshape</span><span class="p">)</span>
    
    <span class="c1"># get general data:</span>
    <span class="k">if</span> <span class="n">camtype</span> <span class="o">==</span> <span class="s1">&#39;ciecam02&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">mcat</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">mcat</span> <span class="o">==</span> <span class="s1">&#39;cat02&#39;</span><span class="p">):</span>
            <span class="n">mcat</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">_MCATS</span><span class="p">[</span><span class="s1">&#39;cat02&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">yellowbluepurplecorrect</span> <span class="o">==</span> <span class="s1">&#39;brill-suss&#39;</span><span class="p">:</span>
                <span class="n">mcat</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">_MCATS</span><span class="p">[</span><span class="s1">&#39;cat02-bs&#39;</span><span class="p">]</span>  <span class="c1"># for yellow-blue problem, Brill [Color Res Appl 2006;31:142-145] and Brill and Süsstrunk [Color Res Appl 2008;33:424-426] </span>
            <span class="k">elif</span> <span class="n">yellowbluepurplecorrect</span> <span class="o">==</span> <span class="s1">&#39;jiang-luo&#39;</span><span class="p">:</span>
                <span class="n">mcat</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">_MCATS</span><span class="p">[</span><span class="s1">&#39;cat02-jiang-luo&#39;</span><span class="p">]</span> <span class="c1"># for yellow-blue problem + purple line problem</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mcat</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="n">mcat</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">_MCATS</span><span class="p">[</span><span class="n">mcat</span><span class="p">]</span>
        <span class="n">invmcat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">mcat</span><span class="p">)</span>
        <span class="n">mhpe</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">_MCATS</span><span class="p">[</span><span class="s1">&#39;hpe&#39;</span><span class="p">]</span>
        <span class="n">mhpe_x_invmcat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mhpe</span><span class="p">,</span><span class="n">invmcat</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;inverse&#39;</span><span class="p">:</span>
            <span class="n">mcat_x_invmhpe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mcat</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">mhpe</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">camtype</span> <span class="o">==</span><span class="s1">&#39;cam16&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">mcat</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mcat</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">_MCATS</span><span class="p">[</span><span class="s1">&#39;cat16&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mcat</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="n">mcat</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">_MCATS</span><span class="p">[</span><span class="n">mcat</span><span class="p">]</span>
            
        <span class="n">invmcat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">mcat</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;.cam.cam_structure_ciecam02_cam16(): Unrecognized camtype&#39;</span><span class="p">)</span>
    
    <span class="c1"># loop through all xyzw:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xyzw</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="c1"># Get condition parameters:</span>

        <span class="n">D</span><span class="p">,</span> <span class="n">Dtype</span><span class="p">,</span> <span class="n">La</span><span class="p">,</span> <span class="n">Yb</span><span class="p">,</span> <span class="n">surround</span> <span class="o">=</span> <span class="p">[</span><span class="n">conditions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">conditions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())]</span> <span class="c1"># unpack dictionary</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">surround</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="n">surround</span> <span class="o">=</span> <span class="n">_CAM_02_X_SURROUND_PARAMETERS</span><span class="p">[</span><span class="n">camtype</span><span class="p">][</span><span class="n">surround</span><span class="p">]</span> <span class="c1">#if surround is not a dict of F,Nc,c values --&gt; get from _CAM_02_X_SURROUND_PARAMETERS</span>
        <span class="n">F</span><span class="p">,</span> <span class="n">FLL</span><span class="p">,</span> <span class="n">Nc</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="n">surround</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">surround</span><span class="o">.</span><span class="n">keys</span><span class="p">())]</span>
 
     
        <span class="c1"># calculate condition dependent parameters:</span>
        <span class="n">k</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">5.0</span><span class="o">*</span><span class="n">La</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">FL</span> <span class="o">=</span> <span class="mf">0.2</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">**</span><span class="mf">4.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">5.0</span><span class="o">*</span><span class="n">La</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span><span class="o">*</span><span class="p">((</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">k</span><span class="o">**</span><span class="mf">4.0</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="mf">5.0</span><span class="o">*</span><span class="n">La</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">))</span> <span class="c1"># luminance adaptation factor</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">Yb</span><span class="o">/</span><span class="n">Yw</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> 
        <span class="n">Nbb</span> <span class="o">=</span> <span class="mf">0.725</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mf">0.2</span>   
        <span class="n">Ncb</span> <span class="o">=</span> <span class="n">Nbb</span>
        <span class="n">z</span> <span class="o">=</span> <span class="mf">1.48</span> <span class="o">+</span> <span class="n">FLL</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="n">yw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">[:,</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="kc">None</span><span class="p">]</span>
        <span class="n">xyzwi</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">xyzw</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">yw</span> <span class="c1"># normalize xyzw</span>

        <span class="c1"># calculate D:</span>
        <span class="k">if</span> <span class="n">D</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">D</span> <span class="o">=</span> <span class="n">F</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">3.6</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="o">-</span><span class="n">La</span><span class="o">-</span><span class="mf">42.0</span><span class="p">)</span><span class="o">/</span><span class="mf">92.0</span><span class="p">))</span>

        <span class="c1"># transform from xyzw to cat sensor space:</span>
        <span class="n">rgbw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mcat</span><span class="p">,</span><span class="n">xyzwi</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

        <span class="c1"># apply von Kries cat to white:</span>
        <span class="n">rgbwc</span> <span class="o">=</span> <span class="p">((</span><span class="mf">100.0</span><span class="o">*</span><span class="n">D</span><span class="o">/</span><span class="n">rgbw</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">D</span><span class="p">))</span><span class="o">*</span><span class="n">rgbw</span> <span class="c1"># factor 100 from ciecam02 is replaced with Yw[i] in cam16, but see &#39;note&#39; in Fairchild&#39;s &quot;Color Appearance Models&quot; (p291 ni 3ed.)</span>

        
        <span class="k">if</span> <span class="n">camtype</span> <span class="o">==</span> <span class="s1">&#39;ciecam02&#39;</span><span class="p">:</span>
            <span class="c1"># convert white from cat02 sensor space to cone sensors (hpe):</span>
            <span class="n">rgbwp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mhpe_x_invmcat</span><span class="p">,</span><span class="n">rgbwc</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="k">elif</span> <span class="n">camtype</span> <span class="o">==</span> <span class="s1">&#39;cam16&#39;</span><span class="p">:</span>
            <span class="n">rgbwp</span> <span class="o">=</span> <span class="n">rgbwc</span><span class="o">.</span><span class="n">T</span> <span class="c1"># in cam16, cat and cone sensor spaces are the same</span>

        <span class="n">pw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">rgbwp</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">yellowbluepurplecorrect</span> <span class="o">==</span> <span class="s1">&#39;brill-suss&#39;</span><span class="p">)</span>  <span class="o">&amp;</span> <span class="p">(</span><span class="n">camtype</span> <span class="o">==</span> <span class="s1">&#39;ciecam02&#39;</span><span class="p">):</span> <span class="c1"># Brill &amp; Susstrunck approach, for purple line problem</span>
            <span class="n">rgbwp</span><span class="p">[</span><span class="n">pw</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        
        <span class="c1"># apply repsonse compression to white:</span>
        <span class="n">rgbwpa</span> <span class="o">=</span> <span class="n">naka_rushton</span><span class="p">(</span><span class="n">FL</span><span class="o">*</span><span class="n">rgbwp</span><span class="o">/</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">cam</span> <span class="o">=</span> <span class="n">camtype</span><span class="p">)</span>
        <span class="n">rgbwpa</span><span class="p">[</span><span class="n">pw</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">-</span> <span class="p">(</span><span class="n">naka_rushton</span><span class="p">(</span><span class="n">FL</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">rgbwp</span><span class="p">[</span><span class="n">pw</span><span class="p">])</span><span class="o">/</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">cam</span> <span class="o">=</span> <span class="n">camtype</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">)</span>
        
        <span class="c1"># split white into separate cone signals:</span>
        <span class="n">rwpa</span><span class="p">,</span> <span class="n">gwpa</span><span class="p">,</span> <span class="n">bwpa</span> <span class="o">=</span> <span class="n">asplit</span><span class="p">(</span><span class="n">rgbwpa</span><span class="p">)</span>
        
        <span class="c1"># Calculate achromatic signal:</span>
        <span class="n">Aw</span> <span class="o">=</span>  <span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">rwpa</span> <span class="o">+</span> <span class="n">gwpa</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">20.0</span><span class="p">)</span><span class="o">*</span><span class="n">bwpa</span> <span class="o">-</span> <span class="mf">0.305</span><span class="p">)</span><span class="o">*</span><span class="n">Nbb</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;forward&#39;</span><span class="p">):</span>
        
            <span class="c1"># calculate stimuli:</span>
            <span class="n">xyzi</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">data</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">yw</span> <span class="c1"># normalize xyzw</span>
            
            <span class="c1"># transform from xyz to cat02 sensor space:</span>
            <span class="n">rgb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mcat</span><span class="p">,</span><span class="n">xyzi</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

            <span class="c1"># apply von Kries cat:</span>
            <span class="n">rgbc</span> <span class="o">=</span> <span class="p">((</span><span class="mf">100.0</span><span class="o">*</span><span class="n">D</span><span class="o">/</span><span class="n">rgbw</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">D</span><span class="p">))</span><span class="o">*</span><span class="n">rgb</span>

            <span class="k">if</span> <span class="n">camtype</span> <span class="o">==</span> <span class="s1">&#39;ciecam02&#39;</span><span class="p">:</span>
                <span class="c1"># convert from cat02 sensor space to cone sensors (hpe):</span>
                <span class="n">rgbp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mhpe_x_invmcat</span><span class="p">,</span><span class="n">rgbc</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
            <span class="k">elif</span> <span class="n">camtype</span> <span class="o">==</span> <span class="s1">&#39;cam16&#39;</span><span class="p">:</span>
                <span class="n">rgbp</span> <span class="o">=</span> <span class="n">rgbc</span><span class="o">.</span><span class="n">T</span> <span class="c1"># in cam16, cat and cone sensor spaces are the same</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">rgbp</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="n">yellowbluepurplecorrect</span> <span class="o">==</span> <span class="s1">&#39;brill-suss&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">camtype</span><span class="o">==</span><span class="s1">&#39;ciecam02&#39;</span><span class="p">):</span> <span class="c1"># Brill &amp; Susstrunck approach, for purple line problem</span>
                <span class="n">rgbp</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>

            <span class="c1"># apply repsonse compression:</span>
            <span class="n">rgbpa</span> <span class="o">=</span> <span class="n">naka_rushton</span><span class="p">(</span><span class="n">FL</span><span class="o">*</span><span class="n">rgbp</span><span class="o">/</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">cam</span> <span class="o">=</span> <span class="n">camtype</span><span class="p">)</span>
            <span class="n">rgbpa</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">-</span> <span class="p">(</span><span class="n">naka_rushton</span><span class="p">(</span><span class="n">FL</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">rgbp</span><span class="p">[</span><span class="n">p</span><span class="p">])</span><span class="o">/</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">cam</span> <span class="o">=</span> <span class="n">camtype</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">)</span>
            
            <span class="c1"># split into separate cone signals:</span>
            <span class="n">rpa</span><span class="p">,</span> <span class="n">gpa</span><span class="p">,</span> <span class="n">bpa</span> <span class="o">=</span> <span class="n">asplit</span><span class="p">(</span><span class="n">rgbpa</span><span class="p">)</span>
            
            <span class="c1"># calculate initial opponent channels:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">rpa</span> <span class="o">-</span> <span class="mf">12.0</span><span class="o">*</span><span class="n">gpa</span><span class="o">/</span><span class="mf">11.0</span> <span class="o">+</span> <span class="n">bpa</span><span class="o">/</span><span class="mf">11.0</span>
            <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">9.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">rpa</span> <span class="o">+</span> <span class="n">gpa</span> <span class="o">-</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">bpa</span><span class="p">)</span>
        
            <span class="c1"># calculate hue h:</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">hue_angle</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span> <span class="n">htype</span> <span class="o">=</span> <span class="s1">&#39;deg&#39;</span><span class="p">)</span>
            
            <span class="c1"># calculate eccentricity factor et:</span>
            <span class="n">et</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">4.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.0</span> <span class="o">+</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">3.8</span><span class="p">)</span>
            
            <span class="c1"># calculate Hue quadrature (if requested in &#39;out&#39;):</span>
            <span class="k">if</span> <span class="s1">&#39;H&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">:</span>    
                <span class="n">H</span> <span class="o">=</span> <span class="n">hue_quadrature</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">unique_hue_data</span> <span class="o">=</span> <span class="n">camtype</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">H</span> <span class="o">=</span> <span class="kc">None</span>
            
            <span class="c1"># Calculate achromatic signal:</span>
            <span class="n">A</span> <span class="o">=</span>  <span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">rpa</span> <span class="o">+</span> <span class="n">gpa</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">20.0</span><span class="p">)</span><span class="o">*</span><span class="n">bpa</span> <span class="o">-</span> <span class="mf">0.305</span><span class="p">)</span><span class="o">*</span><span class="n">Nbb</span>
            
            <span class="c1"># calculate lightness, J:</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;J&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s1">&#39;Q&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s1">&#39;M&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s1">&#39;s&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s1">&#39;aS&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s1">&#39;aC&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s1">&#39;aM&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">):</span>
                <span class="n">J</span> <span class="o">=</span> <span class="mf">100.0</span><span class="o">*</span> <span class="p">(</span><span class="n">A</span> <span class="o">/</span> <span class="n">Aw</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
            
            <span class="c1"># calculate brightness, Q:</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;Q&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s1">&#39;s&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s1">&#39;aS&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">):</span>
                <span class="n">Q</span> <span class="o">=</span> <span class="p">(</span><span class="mf">4.0</span><span class="o">/</span><span class="n">c</span><span class="p">)</span><span class="o">*</span> <span class="p">((</span><span class="n">J</span><span class="o">/</span><span class="mf">100.0</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">Aw</span> <span class="o">+</span> <span class="mf">4.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">FL</span><span class="o">**</span><span class="mf">0.25</span><span class="p">)</span>
            
            <span class="c1"># calculate chroma, C:</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s1">&#39;M&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s1">&#39;s&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s1">&#39;aS&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s1">&#39;aC&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s1">&#39;aM&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">):</span>
                <span class="n">t</span> <span class="o">=</span> <span class="p">((</span><span class="mf">50000.0</span><span class="o">/</span><span class="mf">13.0</span><span class="p">)</span><span class="o">*</span><span class="n">Nc</span><span class="o">*</span><span class="n">Ncb</span><span class="o">*</span><span class="n">et</span><span class="o">*</span><span class="p">((</span><span class="n">a</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">+</span> <span class="n">b</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">rpa</span> <span class="o">+</span> <span class="n">gpa</span> <span class="o">+</span> <span class="p">(</span><span class="mf">21.0</span><span class="o">/</span><span class="mf">20.0</span><span class="o">*</span><span class="n">bpa</span><span class="p">))</span>
                <span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mf">0.9</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">J</span><span class="o">/</span><span class="mf">100.0</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.64</span> <span class="o">-</span> <span class="mf">0.29</span><span class="o">**</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mf">0.73</span>
           
  
            <span class="c1"># calculate colorfulness, M:</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;M&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s1">&#39;s&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s1">&#39;aM&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s1">&#39;aS&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">):</span>
                <span class="n">M</span> <span class="o">=</span> <span class="n">C</span><span class="o">*</span><span class="n">FL</span><span class="o">**</span><span class="mf">0.25</span>
             
            <span class="c1"># calculate saturation, s:</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;s&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s1">&#39;aS&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">):</span>
                <span class="n">s</span> <span class="o">=</span> <span class="mf">100.0</span><span class="o">*</span> <span class="p">(</span><span class="n">M</span><span class="o">/</span><span class="n">Q</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
                
            <span class="c1"># calculate cartesion coordinates:</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;aS&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">):</span>
                 <span class="n">aS</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.0</span><span class="p">)</span>
                 <span class="n">bS</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.0</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;aC&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">):</span>
                 <span class="n">aC</span> <span class="o">=</span> <span class="n">C</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.0</span><span class="p">)</span>
                 <span class="n">bC</span> <span class="o">=</span> <span class="n">C</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.0</span><span class="p">)</span>
                 
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;aM&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">):</span>
                 <span class="n">aM</span> <span class="o">=</span> <span class="n">M</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.0</span><span class="p">)</span>
                 <span class="n">bM</span> <span class="o">=</span> <span class="n">M</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.0</span><span class="p">)</span>
                 
            <span class="k">if</span> <span class="n">outin</span> <span class="o">!=</span> <span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">,</span><span class="s1">&#39;aM&#39;</span><span class="p">,</span><span class="s1">&#39;bM&#39;</span><span class="p">]:</span>
                <span class="n">out_i</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;ajoin((&#39;</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outin</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;))&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out_i</span> <span class="o">=</span> <span class="n">ajoin</span><span class="p">((</span><span class="n">J</span><span class="p">,</span><span class="n">aM</span><span class="p">,</span><span class="n">bM</span><span class="p">))</span>

            <span class="n">camout</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_i</span>
            
            
        <span class="k">elif</span> <span class="p">(</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;inverse&#39;</span><span class="p">):</span>
            
            <span class="c1"># input = J, a, b:</span>
            <span class="n">J</span><span class="p">,</span> <span class="n">aMCs</span><span class="p">,</span> <span class="n">bMCs</span> <span class="o">=</span> <span class="n">asplit</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span>
            
            <span class="c1"># calculate hue h:</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">hue_angle</span><span class="p">(</span><span class="n">aMCs</span><span class="p">,</span><span class="n">bMCs</span><span class="p">,</span> <span class="n">htype</span> <span class="o">=</span> <span class="s1">&#39;deg&#39;</span><span class="p">)</span>
            
            <span class="c1"># calculate M or C or s from a,b:</span>
            <span class="n">MCs</span> <span class="o">=</span> <span class="p">(</span><span class="n">aMCs</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">+</span> <span class="n">bMCs</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>    
            
            
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;Q&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">):</span>
                <span class="n">Q</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">J</span> <span class="o">=</span> <span class="mf">100.0</span><span class="o">*</span><span class="p">(</span><span class="n">Q</span> <span class="o">/</span> <span class="p">((</span><span class="n">Aw</span> <span class="o">+</span> <span class="mf">4.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">FL</span><span class="o">**</span><span class="mf">0.25</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">4.0</span><span class="o">/</span><span class="n">c</span><span class="p">)))</span><span class="o">**</span><span class="mf">2.0</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;aS&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">):</span>
                <span class="n">Q</span> <span class="o">=</span> <span class="p">(</span><span class="mf">4.0</span><span class="o">/</span><span class="n">c</span><span class="p">)</span><span class="o">*</span> <span class="p">((</span><span class="n">J</span><span class="o">/</span><span class="mf">100.0</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">Aw</span> <span class="o">+</span> <span class="mf">4.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">FL</span><span class="o">**</span><span class="mf">0.25</span><span class="p">)</span>
                <span class="n">M</span> <span class="o">=</span> <span class="n">Q</span><span class="o">*</span><span class="p">(</span><span class="n">MCs</span><span class="o">/</span><span class="mf">100.0</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span> 
                <span class="n">C</span> <span class="o">=</span> <span class="n">M</span><span class="o">/</span><span class="p">(</span><span class="n">FL</span><span class="o">**</span><span class="mf">0.25</span><span class="p">)</span>
             
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;aM&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">):</span> <span class="c1"># convert M to C:</span>
                <span class="n">C</span> <span class="o">=</span> <span class="n">MCs</span><span class="o">/</span><span class="p">(</span><span class="n">FL</span><span class="o">**</span><span class="mf">0.25</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;aC&#39;</span> <span class="ow">in</span> <span class="n">outin</span><span class="p">):</span>
                <span class="n">C</span> <span class="o">=</span> <span class="n">MCs</span>
                
            <span class="c1"># calculate t from J, C:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">C</span> <span class="o">/</span> <span class="p">((</span><span class="n">J</span><span class="o">/</span><span class="mf">100.0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.64</span> <span class="o">-</span> <span class="mf">0.29</span><span class="o">**</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mf">0.73</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">0.9</span><span class="p">)</span>
            
            <span class="c1"># calculate eccentricity factor, et:</span>
            <span class="n">et</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.0</span> <span class="o">+</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">3.8</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.0</span>
            
            <span class="c1"># calculate achromatic signal, A:</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">Aw</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">/</span><span class="mf">100.0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">z</span><span class="p">))</span>
            
            <span class="c1"># calculate temporary cart. co. at, bt and p1,p2,p3,p4,p5:</span>
            <span class="n">at</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.0</span><span class="p">)</span>
            <span class="n">bt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.0</span><span class="p">)</span>
            <span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mf">50000.0</span><span class="o">/</span><span class="mf">13.0</span><span class="p">)</span><span class="o">*</span><span class="n">Nc</span><span class="o">*</span><span class="n">Ncb</span><span class="o">*</span><span class="n">et</span><span class="o">/</span><span class="n">t</span>
            <span class="n">p2</span> <span class="o">=</span> <span class="n">A</span><span class="o">/</span><span class="n">Nbb</span> <span class="o">+</span> <span class="mf">0.305</span>
            <span class="n">p3</span> <span class="o">=</span> <span class="mf">21.0</span><span class="o">/</span><span class="mf">20.0</span>
            <span class="n">p4</span> <span class="o">=</span> <span class="n">p1</span><span class="o">/</span><span class="n">bt</span>
            <span class="n">p5</span> <span class="o">=</span> <span class="n">p1</span><span class="o">/</span><span class="n">at</span>

            <span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">bt</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">at</span><span class="p">))</span>


            <span class="n">b</span> <span class="o">=</span> <span class="n">p2</span><span class="o">*</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">+</span> <span class="n">p3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">460.0</span><span class="o">/</span><span class="mf">1403.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">p4</span> <span class="o">+</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">+</span> <span class="n">p3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">220.0</span><span class="o">/</span><span class="mf">1403.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">at</span><span class="o">/</span><span class="n">bt</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">27.0</span><span class="o">/</span><span class="mf">1403.0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p3</span><span class="o">*</span><span class="p">(</span><span class="mf">6300.0</span><span class="o">/</span><span class="mf">1403.0</span><span class="p">))</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="p">(</span><span class="n">at</span><span class="o">/</span><span class="n">bt</span><span class="p">)</span>

            <span class="n">a</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[</span><span class="n">q</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">+</span> <span class="n">p3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">460.0</span><span class="o">/</span><span class="mf">1403.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">p5</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">+</span> <span class="n">p3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">220.0</span><span class="o">/</span><span class="mf">1403.0</span><span class="p">)</span> <span class="o">-</span> <span class="p">((</span><span class="mf">27.0</span><span class="o">/</span><span class="mf">1403.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">p3</span><span class="o">*</span><span class="p">(</span><span class="mf">6300.0</span><span class="o">/</span><span class="mf">1403.0</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">bt</span><span class="p">[</span><span class="n">q</span><span class="p">]</span><span class="o">/</span><span class="n">at</span><span class="p">[</span><span class="n">q</span><span class="p">]))</span>
            <span class="n">b</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">bt</span><span class="p">[</span><span class="n">q</span><span class="p">]</span><span class="o">/</span><span class="n">at</span><span class="p">[</span><span class="n">q</span><span class="p">])</span>
            
            <span class="c1"># calculate post-adaptation values</span>
            <span class="n">rpa</span> <span class="o">=</span> <span class="p">(</span><span class="mf">460.0</span><span class="o">*</span><span class="n">p2</span> <span class="o">+</span> <span class="mf">451.0</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mf">288.0</span><span class="o">*</span><span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1403.0</span>
            <span class="n">gpa</span> <span class="o">=</span> <span class="p">(</span><span class="mf">460.0</span><span class="o">*</span><span class="n">p2</span> <span class="o">-</span> <span class="mf">891.0</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mf">261.0</span><span class="o">*</span><span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1403.0</span>
            <span class="n">bpa</span> <span class="o">=</span> <span class="p">(</span><span class="mf">460.0</span><span class="o">*</span><span class="n">p2</span> <span class="o">-</span> <span class="mf">220.0</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mf">6300.0</span><span class="o">*</span><span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1403.0</span>

            <span class="c1"># join values:</span>
            <span class="n">rgbpa</span> <span class="o">=</span> <span class="n">ajoin</span><span class="p">((</span><span class="n">rpa</span><span class="p">,</span><span class="n">gpa</span><span class="p">,</span><span class="n">bpa</span><span class="p">))</span>
            
            <span class="c1"># decompress signals:</span>
            <span class="n">rgbp</span> <span class="o">=</span> <span class="p">(</span><span class="mf">100.0</span><span class="o">/</span><span class="n">FL</span><span class="p">)</span><span class="o">*</span><span class="n">naka_rushton</span><span class="p">(</span><span class="n">rgbpa</span><span class="p">,</span> <span class="n">cam</span> <span class="o">=</span> <span class="n">camtype</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;inverse&#39;</span><span class="p">)</span>
           
            <span class="k">if</span> <span class="p">(</span><span class="n">yellowbluepurplecorrect</span> <span class="o">==</span> <span class="s1">&#39;brill-suss&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">camtype</span> <span class="o">==</span> <span class="s1">&#39;ciecam02&#39;</span><span class="p">):</span> <span class="c1"># Brill &amp; Susstrunck approach, for purple line problem</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">rgbp</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">)</span>
                <span class="n">rgbp</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
            
            <span class="k">if</span>  <span class="p">(</span><span class="n">camtype</span> <span class="o">==</span> <span class="s1">&#39;ciecam02&#39;</span><span class="p">):</span>
                <span class="c1"># convert from to cone sensors (hpe) cat02 sensor space:</span>
                <span class="n">rgbc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mcat_x_invmhpe</span><span class="p">,</span><span class="n">rgbp</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">camtype</span> <span class="o">==</span> <span class="s1">&#39;cam16&#39;</span><span class="p">):</span>
                <span class="n">rgbc</span> <span class="o">=</span> <span class="n">rgbp</span><span class="o">.</span><span class="n">T</span> <span class="c1"># in cam16, cat and cone sensor spaces are the same</span>
                     
            <span class="c1"># apply inverse von Kries cat:</span>
            <span class="n">rgb</span> <span class="o">=</span> <span class="n">rgbc</span><span class="o">/</span> <span class="p">((</span><span class="mf">100.0</span><span class="o">*</span><span class="n">D</span><span class="o">/</span><span class="n">rgbw</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">D</span><span class="p">))</span>
 
            <span class="c1"># transform from cat sensor space to xyz:</span>
            <span class="n">xyzi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">invmcat</span><span class="p">,</span><span class="n">rgb</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
            
            <span class="c1"># unnormalize data:</span>
            <span class="n">xyzi</span> <span class="o">=</span> <span class="n">xyzi</span><span class="o">*</span><span class="n">yw</span><span class="o">/</span><span class="n">Yw</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> 
            <span class="c1">#xyzi[xyzi&lt;0] = 0</span>
            
            <span class="n">camout</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xyzi</span>
    
    <span class="c1"># return to original shape:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_original_shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">camout</span> <span class="o">=</span> <span class="n">camout</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>   
   
    <span class="k">return</span> <span class="n">camout</span>    


    
    
<span class="c1">#---------------------------------------------------------------------------------------------------------------------</span>
<div class="viewcode-block" id="ciecam02"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.ciecam02">[docs]</a><span class="k">def</span> <span class="nf">ciecam02</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat02&#39;</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">np2d</span><span class="p">(</span><span class="mf">100.0</span><span class="p">),</span>\
             <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;forward&#39;</span><span class="p">,</span> <span class="n">outin</span> <span class="o">=</span> <span class="s1">&#39;J,aM,bM&#39;</span><span class="p">,</span>\
             <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert between XYZ tristsimulus values and ciecam02 color appearance correlates.</span>
<span class="sd">    </span>
<span class="sd">    | Wrapper for luxpy.cam.cam_structure_ciecam02_cam16() designed specifically </span>
<span class="sd">      for camtype = &#39;ciecam02.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        :data: </span>
<span class="sd">            | ndarray with input tristimulus values or </span>
<span class="sd">              input color appearance correlates</span>
<span class="sd">            | Can be of shape: (N [, xM], x 3), whereby </span>
<span class="sd">              N refers to samples, M to light sources.</span>
<span class="sd">        :xyzw:</span>
<span class="sd">            | _CAM_02_X_DEFAULT_WHITE_POINT or ndarray with tristimulus values</span>
<span class="sd">              of white point(s), optional</span>
<span class="sd">            | Can be multiple by specifying a Mx3 ndarray, instead of 1x3.</span>
<span class="sd">        :Yw: </span>
<span class="sd">            | luxpy.np2d(100), optional</span>
<span class="sd">            | Luminance factor of white point.</span>
<span class="sd">            | Is normally 100 for perfect white diffuser, </span>
<span class="sd">              is &lt; 100 for e.g. paper as white point.         </span>
<span class="sd">        :mcat:</span>
<span class="sd">            | &#39;cat02&#39; or str or ndarray, optional</span>
<span class="sd">            | Specifies CAT sensor space.</span>
<span class="sd">            |   - None defaults to the one native to the camtype </span>
<span class="sd">            |      (others e.g. &#39;cat02-bs&#39;, &#39;cat02-jiang&#39;,</span>
<span class="sd">            |      all trying to correct gamut problems of original cat02 matrix)</span>
<span class="sd">            |   - str: see see luxpy.cat._MCATS.keys() for options </span>
<span class="sd">            |    (details on type, ?luxpy.cat)</span>
<span class="sd">            |   - ndarray: matrix with sensor primaries</span>
<span class="sd">        :condition:</span>
<span class="sd">            | luxpy.cam._CAM_02_X_DEFAULT_CONDITIONS, optional</span>
<span class="sd">            | Dict with condition parameters, D, La, surround ([c,Nc,F]), Yb</span>
<span class="sd">            | Can be user defined, but dict must have same structure.</span>
<span class="sd">        :direction:</span>
<span class="sd">            | &#39;forward&#39; or &#39;inverse&#39;, optional</span>
<span class="sd">            |   -&#39;forward&#39;: xyz -&gt; ciecam02 </span>
<span class="sd">            |   -&#39;inverse&#39;: ciecam02 -&gt; xyz </span>
<span class="sd">            |    (input data must be:</span>
<span class="sd">            |         (J or Q, aM, bM) or </span>
<span class="sd">            |         (J or Q, aC,bC) or </span>
<span class="sd">            |         (J or Q, aS, bS) !!)</span>
<span class="sd">        :outin: </span>
<span class="sd">            | &#39;J,aM,bM&#39; or str, optional</span>
<span class="sd">            | Str specifying the type of </span>
<span class="sd">            |   input (:direction: == &#39;inverse&#39;) and </span>
<span class="sd">            |   output (:direction: == &#39;forward&#39;)</span>
<span class="sd">        :yellowbluepurplecorrect:</span>
<span class="sd">            | True or False, optional</span>
<span class="sd">            | Correct for yellow-blue and purple problems in ciecam02 </span>
<span class="sd">              (Is not used in cam16 because cat16 solves issues)</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        :returns: </span>
<span class="sd">            | ndarray with color appearance correlates (:direction: == &#39;forward&#39;) </span>
<span class="sd">            |  or </span>
<span class="sd">            | XYZ tristimulus values (:direction: == &#39;inverse&#39;)</span>
<span class="sd">    </span>
<span class="sd">    References:</span>
<span class="sd">        1. `N. Moroney, M. D. Fairchild, R. W. G. Hunt, C. Li, M. R. Luo, and T. Newman, (2002), </span>
<span class="sd">        &quot;The CIECAM02 color appearance model,” </span>
<span class="sd">        IS&amp;T/SID Tenth Color Imaging Conference. p. 23, 2002.</span>
<span class="sd">        &lt;http://rit-mcsl.org/fairchild/PDFs/PRO19.pdf&gt;`_</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cam_structure_ciecam02_cam16</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">camtype</span> <span class="o">=</span> <span class="s1">&#39;ciecam02&#39;</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span><span class="p">,</span> <span class="n">outin</span> <span class="o">=</span> <span class="n">outin</span><span class="p">,</span> <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="n">yellowbluepurplecorrect</span><span class="p">)</span></div>


<span class="c1">#---------------------------------------------------------------------------------------------------------------------</span>
<div class="viewcode-block" id="cam16"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.cam16">[docs]</a><span class="k">def</span> <span class="nf">cam16</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat16&#39;</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">np2d</span><span class="p">(</span><span class="mf">100.0</span><span class="p">),</span>\
          <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;forward&#39;</span><span class="p">,</span> <span class="n">outin</span> <span class="o">=</span> <span class="s1">&#39;J,aM,bM&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert between XYZ tristsimulus values and cam16 color appearance correlates.</span>
<span class="sd">    </span>
<span class="sd">   | Wrapper for luxpy.cam.cam_structure_ciecam02_cam16() designed specifically </span>
<span class="sd">     for camtype = &#39;cam16&#39;.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        :data: </span>
<span class="sd">            | ndarray with input tristimulus values or </span>
<span class="sd">              input color appearance correlates</span>
<span class="sd">            | Can be of shape: (N [, xM], x 3), whereby </span>
<span class="sd">              N refers to samples, M to light sources.</span>
<span class="sd">        :xyzw:</span>
<span class="sd">            | _CAM_02_X_DEFAULT_WHITE_POINT or ndarray with tristimulus values</span>
<span class="sd">              of white point(s), optional</span>
<span class="sd">            | Can be multiple by specifying a Mx3 ndarray, instead of 1x3.</span>
<span class="sd">        :Yw: </span>
<span class="sd">            | luxpy.np2d(100), optional</span>
<span class="sd">            | Luminance factor of white point.</span>
<span class="sd">            | Is normally 100 for perfect white diffuser, </span>
<span class="sd">              is &lt; 100 for e.g. paper as white point.         </span>
<span class="sd">        :mcat:</span>
<span class="sd">            | &#39;cat16&#39; or str or ndarray, optional</span>
<span class="sd">            | Specifies CAT sensor space.</span>
<span class="sd">            |   - None defaults back to &#39;cat02!&#39;. </span>
<span class="sd">            |      (others e.g. &#39;cat02-bs&#39;, &#39;cat02-jiang&#39;,</span>
<span class="sd">            |      all trying to correct gamut problems of original cat02 matrix)</span>
<span class="sd">            |   - str: see see luxpy.cat._MCATS.keys() for options </span>
<span class="sd">            |    (details on type, ?luxpy.cat)</span>
<span class="sd">            |   - ndarray: matrix with sensor primaries</span>
<span class="sd">        :condition:</span>
<span class="sd">            | luxpy.cam._CAM_02_X_DEFAULT_CONDITIONS, optional</span>
<span class="sd">            | Dict with condition parameters, D, La, surround ([c,Nc,F]), Yb</span>
<span class="sd">            | Can be user defined, but dict must have same structure.</span>
<span class="sd">        :direction:</span>
<span class="sd">            | &#39;forward&#39; or &#39;inverse&#39;, optional</span>
<span class="sd">            |   -&#39;forward&#39;: xyz -&gt; cam16</span>
<span class="sd">            |   -&#39;inverse&#39;: cam16 -&gt; xyz </span>
<span class="sd">            |    (input data must be:</span>
<span class="sd">            |         (J or Q, aM, bM) or </span>
<span class="sd">            |         (J or Q, aC,bC) or </span>
<span class="sd">            |         (J or Q, aS, bS) !!)</span>
<span class="sd">        :outin: </span>
<span class="sd">            | &#39;J,aM,bM&#39; or str, optional</span>
<span class="sd">            | Str specifying the type of </span>
<span class="sd">            |   input (:direction: == &#39;inverse&#39;) and </span>
<span class="sd">            |   output (:direction: == &#39;forward&#39;)</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        :returns: </span>
<span class="sd">            | ndarray with color appearance correlates (:direction: == &#39;forward&#39;) </span>
<span class="sd">            |  or </span>
<span class="sd">            | XYZ tristimulus values (:direction: == &#39;inverse&#39;)</span>
<span class="sd">    </span>
<span class="sd">    References:</span>
<span class="sd">        ..[1] C. Li, Z. Li, Z. Wang, Y. Xu, M. R. Luo, G. Cui, M. Melgosa, M. H. Brill, and M. Pointer, </span>
<span class="sd">            “Comprehensive color solutions: CAM16, CAT16, and CAM16-UCS,” </span>
<span class="sd">            Color Res. Appl., p. n/a–n/a.</span>
<span class="sd"> </span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">return</span> <span class="n">cam_structure_ciecam02_cam16</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">camtype</span> <span class="o">=</span> <span class="s1">&#39;cam16&#39;</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span><span class="p">,</span> <span class="n">outin</span> <span class="o">=</span> <span class="n">outin</span><span class="p">,</span> <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span></div>

<span class="c1">#---------------------------------------------------------------------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">camucs_structure</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">camtype</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_TYPE</span><span class="p">,</span> \
                     <span class="n">mcat</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">np2d</span><span class="p">(</span><span class="mf">100.0</span><span class="p">),</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span> \
                     <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;forward&#39;</span><span class="p">,</span> <span class="n">outin</span> <span class="o">=</span> <span class="s1">&#39;J,aM,bM&#39;</span><span class="p">,</span> <span class="n">ucstype</span> <span class="o">=</span> <span class="s1">&#39;ucs&#39;</span><span class="p">,</span> \
                     <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert between XYZ tristsimulus values </span>
<span class="sd">    and camucs type color appearance correlates.</span>
<span class="sd">    </span>
<span class="sd">    | Wrapper for luxpy.cam.cam_structure_ciecam02_cam16() with additional </span>
<span class="sd">      compression of color attributes</span>
<span class="sd">      for the following case:</span>
<span class="sd">    |    - &#39;none&#39;: original cam space</span>
<span class="sd">    |    - &#39;ucs&#39;: for uniform color space</span>
<span class="sd">    |    - &#39;lcd&#39;: for large color differences</span>
<span class="sd">    |    - &#39;scd&#39;: for small color differences</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        :data: </span>
<span class="sd">            | ndarray with input tristimulus values or </span>
<span class="sd">              input color appearance correlates</span>
<span class="sd">            | Can be of shape: (N [, xM], x 3), whereby </span>
<span class="sd">              N refers to samples, M to light sources.</span>
<span class="sd">        :xyzw:</span>
<span class="sd">            | _CAM_02_X_DEFAULT_WHITE_POINT or ndarray with tristimulus values</span>
<span class="sd">              of white point(s), optional</span>
<span class="sd">            | Can be multiple by specifying a Mx3 ndarray, instead of 1x3.</span>
<span class="sd">        :Yw: </span>
<span class="sd">            | luxpy.np2d(100), optional</span>
<span class="sd">            | Luminance factor of white point.</span>
<span class="sd">            | Is normally 100 for perfect white diffuser, </span>
<span class="sd">              is &lt; 100 for e.g. paper as white point.         </span>
<span class="sd">        :camtype: </span>
<span class="sd">            | luxpy.cam._CAM_02_X_DEFAULT_TYPE, optional</span>
<span class="sd">            | Str specifier for CAM type to use, options: &#39;ciecam02&#39; or &#39;cam16&#39;.</span>
<span class="sd">        :mcat:</span>
<span class="sd">            | None or str or ndarray, optional</span>
<span class="sd">            | Specifies CAT sensor space.</span>
<span class="sd">            |   - None defaults to the one native to the camtype </span>
<span class="sd">            |      (others e.g. &#39;cat02-bs&#39;, &#39;cat02-jiang&#39;,</span>
<span class="sd">            |      all trying to correct gamut problems of original cat02 matrix)</span>
<span class="sd">            |   - str: see see luxpy.cat._MCATS.keys() for options </span>
<span class="sd">            |    (details on type, ?luxpy.cat)</span>
<span class="sd">            |   - ndarray: matrix with sensor primaries</span>
<span class="sd">        :condition:</span>
<span class="sd">            | luxpy.cam._CAM_02_X_DEFAULT_CONDITIONS, optional</span>
<span class="sd">            | Dict with condition parameters, D, La, surround ([c,Nc,F]), Yb</span>
<span class="sd">            | Can be user defined, but dict must have same structure.</span>
<span class="sd">        :direction:</span>
<span class="sd">            | &#39;forward&#39; or &#39;inverse&#39;, optional</span>
<span class="sd">            |   -&#39;forward&#39;: xyz -&gt; camucs</span>
<span class="sd">            |   -&#39;inverse&#39;: camucs -&gt; xyz </span>
<span class="sd">            |    (input data must be:</span>
<span class="sd">            |         (J or Q, aM, bM) or </span>
<span class="sd">            |         (J or Q, aC,bC) or </span>
<span class="sd">            |         (J or Q, aS, bS) !!)</span>
<span class="sd">        :outin: </span>
<span class="sd">            | &#39;J,aM,bM&#39; or str, optional</span>
<span class="sd">            | Str specifying the type of </span>
<span class="sd">            |   input (:direction: == &#39;inverse&#39;) and </span>
<span class="sd">            |   output (:direction: == &#39;forward&#39;)</span>
<span class="sd">        :yellowbluepurplecorrect:</span>
<span class="sd">            | True or False, optional</span>
<span class="sd">            | Correct for yellow-blue and purple problems in ciecam02 </span>
<span class="sd">              (Is not used in cam16 because cat16 solves issues)</span>
<span class="sd">        :ucstype: </span>
<span class="sd">            |&#39;ucs&#39; or &#39;lcd&#39; or &#39;scd&#39;, optional</span>
<span class="sd">            | Str specifier for which type of color attribute compression </span>
<span class="sd">            | parameters to use:</span>
<span class="sd">            |     -&#39;ucs&#39;: uniform color space, </span>
<span class="sd">            |     -&#39;lcd&#39;, large color differences, </span>
<span class="sd">            |     -&#39;scd&#39;: small color differences</span>
<span class="sd">                         </span>
<span class="sd">    Returns:</span>
<span class="sd">        :returns: </span>
<span class="sd">            | ndarray with color appearance correlates (:direction: == &#39;forward&#39;) </span>
<span class="sd">            |  or </span>
<span class="sd">            | XYZ tristimulus values (:direction: == &#39;inverse&#39;)</span>
<span class="sd">    </span>
<span class="sd">    References:</span>
<span class="sd">        1. `C. Li, Z. Li, Z. Wang, Y. Xu, M. R. Luo, G. Cui, M. Melgosa, M. H. Brill, and M. Pointer, (2017), </span>
<span class="sd">        “Comprehensive color solutions: CAM16, CAT16, and CAM16-UCS,” </span>
<span class="sd">        Color Res. Appl., p. n/a–n/a.</span>
<span class="sd">        &lt;http://onlinelibrary.wiley.com/doi/10.1002/col.22131/abstract&gt;`_</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mcat</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">camtype</span> <span class="o">==</span> <span class="s1">&#39;ciecam02&#39;</span><span class="p">:</span>
            <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat02&#39;</span>
        <span class="k">elif</span> <span class="n">camtype</span> <span class="o">==</span> <span class="s1">&#39;cam16&#39;</span><span class="p">:</span>
            <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat16&#39;</span>

    <span class="c1"># get cam02 parameters:</span>
    <span class="n">KL</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="p">[</span><span class="n">_CAM_02_X_UCS_PARAMETERS</span><span class="p">[</span><span class="n">camtype</span><span class="p">][</span><span class="n">ucstype</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">_CAM_02_X_UCS_PARAMETERS</span><span class="p">[</span><span class="n">camtype</span><span class="p">][</span><span class="n">ucstype</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())]</span>
    
    <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;forward&#39;</span><span class="p">:</span>
        
        <span class="c1"># calculate ciecam02 J, aM,bM:</span>
        <span class="n">J</span><span class="p">,</span> <span class="n">aM</span><span class="p">,</span> <span class="n">bM</span> <span class="o">=</span> <span class="n">asplit</span><span class="p">(</span><span class="n">cam_structure_ciecam02_cam16</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">camtype</span> <span class="o">=</span> <span class="n">camtype</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;forward&#39;</span><span class="p">,</span> <span class="n">outin</span> <span class="o">=</span> <span class="n">outin</span><span class="p">,</span><span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="n">yellowbluepurplecorrect</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">))</span>

        <span class="c1"># convert to cam02ucs J&#39;, aM&#39;, bM&#39;:</span>
        <span class="n">M</span>  <span class="o">=</span> <span class="p">(</span><span class="n">aM</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">+</span> <span class="n">bM</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span> 
        <span class="n">h</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">bM</span><span class="p">,</span><span class="n">aM</span><span class="p">)</span>
        <span class="n">Jp</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">100.0</span><span class="o">*</span><span class="n">c1</span><span class="p">)</span><span class="o">*</span><span class="n">J</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">c1</span><span class="o">*</span><span class="n">J</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">c2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">Mp</span> <span class="o">=</span> <span class="n">M</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Mp</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">c2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="n">M</span><span class="p">)</span>
        <span class="n">aMp</span> <span class="o">=</span> <span class="n">Mp</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="n">bMp</span> <span class="o">=</span> <span class="n">Mp</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">ajoin</span><span class="p">((</span><span class="n">Jp</span><span class="p">,</span><span class="n">aMp</span><span class="p">,</span><span class="n">bMp</span><span class="p">))</span>
        
    <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;inverse&#39;</span><span class="p">:</span>
        
    <span class="c1"># convert J&#39;,aM&#39;, bM&#39; to ciecam02 J,aM,bM:</span>
        <span class="c1"># calc CAM02 hue angle</span>
        <span class="n">Jp</span><span class="p">,</span><span class="n">aMp</span><span class="p">,</span><span class="n">bMp</span> <span class="o">=</span> <span class="n">asplit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">h</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">bMp</span><span class="p">,</span><span class="n">aMp</span><span class="p">)</span>

        <span class="c1"># calc CAM02 and CIECAM02 colourfulness</span>
        <span class="n">Mp</span> <span class="o">=</span> <span class="p">(</span><span class="n">aMp</span><span class="o">**</span><span class="mf">2.0</span><span class="o">+</span><span class="n">bMp</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="n">M</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">c2</span><span class="o">*</span><span class="n">Mp</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">c2</span>
        
        <span class="c1"># calculate ciecam02 aM, bM:</span>
        <span class="n">aM</span> <span class="o">=</span> <span class="n">M</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="n">bM</span> <span class="o">=</span> <span class="n">M</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

        <span class="c1"># calc CAM02 lightness</span>
        <span class="n">J</span> <span class="o">=</span> <span class="n">Jp</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="p">(</span><span class="mf">100.0</span> <span class="o">-</span> <span class="n">Jp</span><span class="p">)</span><span class="o">*</span><span class="n">c1</span><span class="p">)</span>
        
        <span class="n">data</span> <span class="o">=</span> <span class="n">ajoin</span><span class="p">((</span><span class="n">J</span><span class="p">,</span><span class="n">aM</span><span class="p">,</span><span class="n">bM</span><span class="p">))</span>
        
        <span class="c1"># calculate xyz from ciecam02 J,aM,bM</span>
        <span class="k">return</span> <span class="n">cam_structure_ciecam02_cam16</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">camtype</span> <span class="o">=</span> <span class="n">camtype</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;inverse&#39;</span><span class="p">,</span> <span class="n">outin</span> <span class="o">=</span> <span class="s1">&#39;J,aM,bM&#39;</span><span class="p">,</span><span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="n">yellowbluepurplecorrect</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span>
     
<span class="c1">#---------------------------------------------------------------------------------------------------------------------</span>
<div class="viewcode-block" id="cam02ucs"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.cam02ucs">[docs]</a><span class="k">def</span> <span class="nf">cam02ucs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> \
             <span class="n">Yw</span> <span class="o">=</span> <span class="n">np2d</span><span class="p">(</span><span class="mf">100.0</span><span class="p">),</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span> \
             <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;forward&#39;</span><span class="p">,</span> <span class="n">ucstype</span> <span class="o">=</span> <span class="s1">&#39;ucs&#39;</span><span class="p">,</span> <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> \
             <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat02&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert between XYZ tristsimulus values </span>
<span class="sd">    and cam02ucs type color appearance correlates.</span>
<span class="sd">    </span>
<span class="sd">    | Wrapper for luxpy.cam.camucs_structure() specifically </span>
<span class="sd">      designed for &#39;ciecam02&#39; + &#39;ucs&#39;</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        :data: </span>
<span class="sd">            | ndarray with input tristimulus values or </span>
<span class="sd">              input color appearance correlates</span>
<span class="sd">            | Can be of shape: (N [, xM], x 3), whereby </span>
<span class="sd">              N refers to samples, M to light sources.</span>
<span class="sd">        :xyzw:</span>
<span class="sd">            | _CAM_02_X_DEFAULT_WHITE_POINT or ndarray with tristimulus values</span>
<span class="sd">              of white point(s), optional</span>
<span class="sd">            | Can be multiple by specifying a Mx3 ndarray, instead of 1x3.</span>
<span class="sd">        :Yw: </span>
<span class="sd">            | luxpy.np2d(100), optional</span>
<span class="sd">            | Luminance factor of white point.</span>
<span class="sd">            | Is normally 100 for perfect white diffuser, </span>
<span class="sd">              is &lt; 100 for e.g. paper as white point.         </span>
<span class="sd">        :mcat:</span>
<span class="sd">            | &#39;cat02&#39; or str or ndarray, optional</span>
<span class="sd">            | Specifies CAT sensor space.</span>
<span class="sd">            |   - None defaults to the one native to the camtype </span>
<span class="sd">            |      (others e.g. &#39;cat02-bs&#39;, &#39;cat02-jiang&#39;,</span>
<span class="sd">            |      all trying to correct gamut problems of original cat02 matrix)</span>
<span class="sd">            |   - str: see see luxpy.cat._MCATS.keys() for options </span>
<span class="sd">            |     (details on type, ?luxpy.cat)</span>
<span class="sd">            |   - ndarray: matrix with sensor primaries</span>
<span class="sd">        :condition:</span>
<span class="sd">            | luxpy.cam._CAM_02_X_DEFAULT_CONDITIONS, optional</span>
<span class="sd">            | Dict with condition parameters, D, La, surround ([c,Nc,F]), Yb</span>
<span class="sd">            | Can be user defined, but dict must have same structure.</span>
<span class="sd">        :direction:</span>
<span class="sd">            | &#39;forward&#39; or &#39;inverse&#39;, optional</span>
<span class="sd">            |   -&#39;forward&#39;: xyz -&gt; cam02ucs</span>
<span class="sd">            |   -&#39;inverse&#39;: cam02ucs -&gt; xyz </span>
<span class="sd">            |    (input data must be:</span>
<span class="sd">            |         (J or Q, aM, bM) or </span>
<span class="sd">            |         (J or Q, aC,bC) or </span>
<span class="sd">            |         (J or Q, aS, bS) !!)</span>
<span class="sd">        :outin: </span>
<span class="sd">            | &#39;J,aM,bM&#39; or str, optional</span>
<span class="sd">            | Str specifying the type of </span>
<span class="sd">            |   input (:direction: == &#39;inverse&#39;) and </span>
<span class="sd">            |   output (:direction: == &#39;forward&#39;)</span>
<span class="sd">        :yellowbluepurplecorrect:</span>
<span class="sd">            | True or False, optional</span>
<span class="sd">            | Correct for yellow-blue and purple problems in ciecam02 </span>
<span class="sd">              (Is not used in cam16 because cat16 solves issues)</span>
<span class="sd">        :ucstype: </span>
<span class="sd">            | &#39;ucs&#39; or &#39;lcd&#39; or &#39;scd&#39;, optional</span>
<span class="sd">            | Str specifier for which type of color attribute compression </span>
<span class="sd">            | parameters to use:</span>
<span class="sd">            |     -&#39;ucs&#39;: uniform color space, </span>
<span class="sd">            |     -&#39;lcd&#39;, large color differences, </span>
<span class="sd">            |     -&#39;scd&#39;: small color differences</span>
<span class="sd">                         </span>
<span class="sd">    Returns:</span>
<span class="sd">        :returns: </span>
<span class="sd">            | ndarray with color appearance correlates (:direction: == &#39;forward&#39;) </span>
<span class="sd">            |  or </span>
<span class="sd">            | XYZ tristimulus values (:direction: == &#39;inverse&#39;)</span>
<span class="sd">     </span>
<span class="sd">    References:</span>
<span class="sd">        1. `M.R. Luo, G. Cui, and C. Li, </span>
<span class="sd">        &#39;Uniform colour spaces based on CIECAM02 colour appearance model,&#39; </span>
<span class="sd">        Color Res. Appl., vol. 31, no. 4, pp. 320–330, 2006.</span>
<span class="sd">        &lt;http://onlinelibrary.wiley.com/doi/10.1002/col.20227/abstract)&gt;`_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">camucs_structure</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">camtype</span> <span class="o">=</span> <span class="s1">&#39;ciecam02&#39;</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span><span class="p">,</span> <span class="n">ucstype</span> <span class="o">=</span> <span class="n">ucstype</span><span class="p">,</span> <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="n">yellowbluepurplecorrect</span><span class="p">)</span></div>

 <span class="c1">#---------------------------------------------------------------------------------------------------------------------</span>
<div class="viewcode-block" id="cam16ucs"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.cam16ucs">[docs]</a><span class="k">def</span> <span class="nf">cam16ucs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">np2d</span><span class="p">(</span><span class="mf">100.0</span><span class="p">),</span> \
             <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;forward&#39;</span><span class="p">,</span> \
             <span class="n">ucstype</span> <span class="o">=</span> <span class="s1">&#39;ucs&#39;</span><span class="p">,</span>  <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat16&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert between XYZ tristsimulus values and cam16ucs type color appearance correlates.</span>
<span class="sd">    </span>
<span class="sd">    | Wrapper for luxpy.cam.camucs_structure() </span>
<span class="sd">      specifically designed for &#39;cam16&#39; + &#39;ucs&#39;</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        :data: </span>
<span class="sd">            | ndarray with input tristimulus values or </span>
<span class="sd">              input color appearance correlates</span>
<span class="sd">            | Can be of shape: (N [, xM], x 3), whereby </span>
<span class="sd">              N refers to samples, M to light sources.</span>
<span class="sd">        :xyzw:</span>
<span class="sd">            | _CAM_02_X_DEFAULT_WHITE_POINT or ndarray with tristimulus values</span>
<span class="sd">              of white point(s), optional</span>
<span class="sd">            | Can be multiple by specifying a Mx3 ndarray, instead of 1x3.</span>
<span class="sd">        :Yw: </span>
<span class="sd">            | luxpy.np2d(100), optional</span>
<span class="sd">            | Luminance factor of white point.</span>
<span class="sd">            | Is normally 100 for perfect white diffuser, </span>
<span class="sd">              is &lt; 100 for e.g. paper as white point.         .</span>
<span class="sd">        :mcat:</span>
<span class="sd">            | &#39;cat16&#39; or str or ndarray, optional</span>
<span class="sd">            | Specifies CAT sensor space.</span>
<span class="sd">            |   - None defaults to &#39;cat02&#39;!</span>
<span class="sd">            |      (others e.g. &#39;cat02-bs&#39;, &#39;cat02-jiang&#39;,</span>
<span class="sd">            |      all trying to correct gamut problems of original cat02 matrix)</span>
<span class="sd">            |   - str: see see luxpy.cat._MCATS.keys() for options </span>
<span class="sd">            |    (details on type, ?luxpy.cat)</span>
<span class="sd">            |   - ndarray: matrix with sensor primaries</span>
<span class="sd">        :condition:</span>
<span class="sd">            | luxpy.cam._CAM_02_X_DEFAULT_CONDITIONS, optional</span>
<span class="sd">            | Dict with condition parameters, D, La, surround ([c,Nc,F]), Yb</span>
<span class="sd">            | Can be user defined, but dict must have same structure.</span>
<span class="sd">        :direction:</span>
<span class="sd">            | &#39;forward&#39; or &#39;inverse&#39;, optional</span>
<span class="sd">            |   -&#39;forward&#39;: xyz -&gt; cam16ucs</span>
<span class="sd">            |   -&#39;inverse&#39;: cam16ucs -&gt; xyz </span>
<span class="sd">            |    (input data must be:</span>
<span class="sd">            |         (J or Q, aM, bM) or </span>
<span class="sd">            |         (J or Q, aC,bC) or </span>
<span class="sd">            |         (J or Q, aS, bS) !!)</span>
<span class="sd">        :outin: </span>
<span class="sd">            | &#39;J,aM,bM&#39; or str, optional</span>
<span class="sd">            | Str specifying the type of </span>
<span class="sd">            |   input (:direction: == &#39;inverse&#39;) and </span>
<span class="sd">            |   output (:direction: == &#39;forward&#39;)</span>
<span class="sd">        :yellowbluepurplecorrect:</span>
<span class="sd">            | True or False, optional</span>
<span class="sd">            | Correct for yellow-blue and purple problems in ciecam02 </span>
<span class="sd">              (Is not used in cam16 because cat16 solves issues)</span>
<span class="sd">        :ucstype: </span>
<span class="sd">            | &#39;ucs&#39; or &#39;lcd&#39; or &#39;scd&#39;, optional</span>
<span class="sd">            | Str specifier for which type of color attribute compression </span>
<span class="sd">            | parameters to use:</span>
<span class="sd">            |     -&#39;ucs&#39;: uniform color space, </span>
<span class="sd">            |     -&#39;lcd&#39;, large color differences, </span>
<span class="sd">            |     -&#39;scd&#39;: small color differences</span>
<span class="sd">                         </span>
<span class="sd">    Returns:</span>
<span class="sd">        :returns: </span>
<span class="sd">            | ndarray with color appearance correlates (:direction: == &#39;forward&#39;) </span>
<span class="sd">            |  or </span>
<span class="sd">            | XYZ tristimulus values (:direction: == &#39;inverse&#39;)</span>
<span class="sd">     </span>
<span class="sd">    References:</span>
<span class="sd">        1. `M. R. Luo, G. Cui, and C. Li, (2006),</span>
<span class="sd">        “Uniform colour spaces based on CIECAM02 colour appearance model,” </span>
<span class="sd">        Color Res. Appl., vol. 31, no. 4, pp. 320–330.</span>
<span class="sd">        &lt;http://onlinelibrary.wiley.com/doi/10.1002/col.20227/abstract)&gt;`_</span>
<span class="sd">        2. `C. Li, Z. Li, Z. Wang, Y. Xu, M. R. Luo, G. Cui, M. Melgosa, M. H. Brill, and M. Pointer, (2017), </span>
<span class="sd">        “Comprehensive color solutions: CAM16, CAT16, and CAM16-UCS,” </span>
<span class="sd">        Color Res. Appl., p. n/a–n/a.</span>
<span class="sd">        &lt;http://onlinelibrary.wiley.com/doi/10.1002/col.22131/abstract)&gt;`_</span>
<span class="sd">     &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">camucs_structure</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">camtype</span> <span class="o">=</span> <span class="s1">&#39;cam16&#39;</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span><span class="p">,</span> <span class="n">ucstype</span> <span class="o">=</span> <span class="n">ucstype</span><span class="p">,</span> <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span></div>
  
     

<span class="c1">#------------------------------------------------------------------------------</span>
<span class="c1"># wrapper function for use with colortf():</span>
<div class="viewcode-block" id="xyz_to_jabM_ciecam02"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.xyz_to_jabM_ciecam02">[docs]</a><span class="k">def</span> <span class="nf">xyz_to_jabM_ciecam02</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span>\
                         <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span> \
                         <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat02&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for ciecam02 forward mode with J,aM,bM output.</span>
<span class="sd">    </span>
<span class="sd">    | For help on parameter details: ?luxpy.cam.ciecam02 </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ciecam02</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;forward&#39;</span><span class="p">,</span> <span class="n">outin</span> <span class="o">=</span> <span class="s1">&#39;J,aM,bM&#39;</span><span class="p">,</span> <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="n">yellowbluepurplecorrect</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span></div>
   
<div class="viewcode-block" id="jabM_ciecam02_to_xyz"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.jabM_ciecam02_to_xyz">[docs]</a><span class="k">def</span> <span class="nf">jabM_ciecam02_to_xyz</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span>\
                         <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span> \
                         <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat02&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for ciecam02 inverse mode with J,aM,bM input.</span>
<span class="sd">    </span>
<span class="sd">    | For help on parameter details: ?luxpy.cam.ciecam02 </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ciecam02</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;inverse&#39;</span><span class="p">,</span> <span class="n">outin</span> <span class="o">=</span> <span class="s1">&#39;J,aM,bM&#39;</span><span class="p">,</span> <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="n">yellowbluepurplecorrect</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span></div>



<div class="viewcode-block" id="xyz_to_jabC_ciecam02"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.xyz_to_jabC_ciecam02">[docs]</a><span class="k">def</span> <span class="nf">xyz_to_jabC_ciecam02</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span> \
                         <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span> \
                         <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat02&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for ciecam02 forward mode with J,aC,bC output.</span>
<span class="sd">    </span>
<span class="sd">    | For help on parameter details: ?luxpy.cam.ciecam02 </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ciecam02</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;forward&#39;</span><span class="p">,</span> <span class="n">outin</span> <span class="o">=</span> <span class="s1">&#39;J,aC,bC&#39;</span><span class="p">,</span> <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="n">yellowbluepurplecorrect</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span></div>
 
<div class="viewcode-block" id="jabC_ciecam02_to_xyz"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.jabC_ciecam02_to_xyz">[docs]</a><span class="k">def</span> <span class="nf">jabC_ciecam02_to_xyz</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span> \
                         <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span> \
                         <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat02&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for ciecam02 inverse mode with J,aC,bC input.</span>
<span class="sd">    </span>
<span class="sd">    | For help on parameter details: ?luxpy.cam.ciecam02 </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ciecam02</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;inverse&#39;</span><span class="p">,</span> <span class="n">outin</span> <span class="o">=</span> <span class="s1">&#39;J,aC,bC&#39;</span><span class="p">,</span> <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="n">yellowbluepurplecorrect</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span></div>


              
<div class="viewcode-block" id="xyz_to_jab_cam02ucs"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.xyz_to_jab_cam02ucs">[docs]</a><span class="k">def</span> <span class="nf">xyz_to_jab_cam02ucs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span>\
                        <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span> \
                        <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat02&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for cam02ucs forward mode with J,aM,bM output.</span>
<span class="sd">    </span>
<span class="sd">    | For help on parameter details: ?luxpy.cam.cam02ucs </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cam02ucs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;forward&#39;</span><span class="p">,</span> <span class="n">ucstype</span> <span class="o">=</span> <span class="s1">&#39;ucs&#39;</span><span class="p">,</span> <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="n">yellowbluepurplecorrect</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span></div>
                
<div class="viewcode-block" id="jab_cam02ucs_to_xyz"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.jab_cam02ucs_to_xyz">[docs]</a><span class="k">def</span> <span class="nf">jab_cam02ucs_to_xyz</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span> \
                        <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span> \
                        <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat02&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for cam02ucs inverse mode with J,aM,bM input.</span>
<span class="sd">    </span>
<span class="sd">    | For help on parameter details: ?luxpy.cam.cam02ucs </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cam02ucs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;inverse&#39;</span><span class="p">,</span> <span class="n">ucstype</span> <span class="o">=</span> <span class="s1">&#39;ucs&#39;</span><span class="p">,</span> <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="n">yellowbluepurplecorrect</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span></div>



<div class="viewcode-block" id="xyz_to_jab_cam02lcd"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.xyz_to_jab_cam02lcd">[docs]</a><span class="k">def</span> <span class="nf">xyz_to_jab_cam02lcd</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span> \
                        <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span> \
                        <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat02&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for cam02ucs forward mode with J,aMp,bMp output and ucstype = lcd.</span>
<span class="sd">    </span>
<span class="sd">    | For help on parameter details: ?luxpy.cam.cam02ucs </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cam02ucs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;forward&#39;</span><span class="p">,</span> <span class="n">ucstype</span> <span class="o">=</span> <span class="s1">&#39;lcd&#39;</span><span class="p">,</span> <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="n">yellowbluepurplecorrect</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span></div>
                
<div class="viewcode-block" id="jab_cam02lcd_to_xyz"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.jab_cam02lcd_to_xyz">[docs]</a><span class="k">def</span> <span class="nf">jab_cam02lcd_to_xyz</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span> \
                        <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span> \
                        <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat02&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for cam02ucs inverse mode with J,aMp,bMp input and ucstype = lcd.</span>
<span class="sd">    </span>
<span class="sd">    | For help on parameter details: ?luxpy.cam.cam02ucs </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cam02ucs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;inverse&#39;</span><span class="p">,</span> <span class="n">ucstype</span> <span class="o">=</span> <span class="s1">&#39;lcd&#39;</span><span class="p">,</span> <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="n">yellowbluepurplecorrect</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span></div>



<div class="viewcode-block" id="xyz_to_jab_cam02scd"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.xyz_to_jab_cam02scd">[docs]</a><span class="k">def</span> <span class="nf">xyz_to_jab_cam02scd</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span> \
                        <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span> \
                        <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat02&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for cam02ucs forward mode with J,aMp,bMp output and ucstype = scd.</span>
<span class="sd">    </span>
<span class="sd">    | For help on parameter details: ?luxpy.cam.cam02ucs </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cam02ucs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;forward&#39;</span><span class="p">,</span> <span class="n">ucstype</span> <span class="o">=</span> <span class="s1">&#39;scd&#39;</span><span class="p">,</span> <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="n">yellowbluepurplecorrect</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span></div>
                
<div class="viewcode-block" id="jab_cam02scd_to_xyz"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.jab_cam02scd_to_xyz">[docs]</a><span class="k">def</span> <span class="nf">jab_cam02scd_to_xyz</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span> \
                        <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span> \
                        <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat02&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for cam02ucs inverse mode with J,aMp,bMp input and ucstype = scd.</span>
<span class="sd">    </span>
<span class="sd">    | For help on parameter details: ?luxpy.cam.cam02ucs </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cam02ucs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;inverse&#39;</span><span class="p">,</span> <span class="n">ucstype</span> <span class="o">=</span> <span class="s1">&#39;scd&#39;</span><span class="p">,</span> <span class="n">yellowbluepurplecorrect</span> <span class="o">=</span> <span class="n">yellowbluepurplecorrect</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span></div>



<span class="c1">#------------------------------------------------------------------------------</span>
<div class="viewcode-block" id="xyz_to_jabM_cam16"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.xyz_to_jabM_cam16">[docs]</a><span class="k">def</span> <span class="nf">xyz_to_jabM_cam16</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span> \
                      <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span>  <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat16&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for cam16 forward mode with J,aM,bM output.</span>
<span class="sd">    </span>
<span class="sd">    | For help on parameter details: ?luxpy.cam.cam16 </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cam16</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;forward&#39;</span><span class="p">,</span> <span class="n">outin</span> <span class="o">=</span> <span class="s1">&#39;J,aM,bM&#39;</span><span class="p">,</span>  <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span></div>
   
<div class="viewcode-block" id="jabM_cam16_to_xyz"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.jabM_cam16_to_xyz">[docs]</a><span class="k">def</span> <span class="nf">jabM_cam16_to_xyz</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span> \
                      <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span>  <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat16&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for cam16 inverse mode with J,aM,bM input.</span>
<span class="sd">    </span>
<span class="sd">    | For help on parameter details: ?luxpy.cam.cam16 </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cam16</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;inverse&#39;</span><span class="p">,</span> <span class="n">outin</span> <span class="o">=</span> <span class="s1">&#39;J,aM,bM&#39;</span><span class="p">,</span>  <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span></div>


<div class="viewcode-block" id="xyz_to_jabC_cam16"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.xyz_to_jabC_cam16">[docs]</a><span class="k">def</span> <span class="nf">xyz_to_jabC_cam16</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span> \
                      <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span>  <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat16&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for cam16 forward mode with J,aC,bC output.</span>
<span class="sd">    </span>
<span class="sd">    | For help on parameter details: ?luxpy.cam.cam16 </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cam16</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;forward&#39;</span><span class="p">,</span> <span class="n">outin</span> <span class="o">=</span> <span class="s1">&#39;J,aC,bC&#39;</span><span class="p">,</span>  <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span></div>
   
<div class="viewcode-block" id="jabC_cam16_to_xyz"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.jabC_cam16_to_xyz">[docs]</a><span class="k">def</span> <span class="nf">jabC_cam16_to_xyz</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span> \
                      <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span>  <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat16&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for cam16 inverse mode with J,aC,bC input.</span>
<span class="sd">    </span>
<span class="sd">    | For help on parameter details: ?luxpy.cam.cam16 </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cam16</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;inverse&#39;</span><span class="p">,</span> <span class="n">outin</span> <span class="o">=</span> <span class="s1">&#39;J,aC,bC&#39;</span><span class="p">,</span>  <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span></div>


              
<div class="viewcode-block" id="xyz_to_jab_cam16ucs"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.xyz_to_jab_cam16ucs">[docs]</a><span class="k">def</span> <span class="nf">xyz_to_jab_cam16ucs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span> \
                        <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span>  <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat16&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for cam16ucs forward mode with J,aM,bM output and ucstype = &#39;ucs&#39;.</span>
<span class="sd">    </span>
<span class="sd">    | For help on parameter details: ?luxpy.cam.cam16ucs </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cam16ucs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;forward&#39;</span><span class="p">,</span> <span class="n">ucstype</span> <span class="o">=</span> <span class="s1">&#39;ucs&#39;</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span></div>
                
<div class="viewcode-block" id="jab_cam16ucs_to_xyz"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.jab_cam16ucs_to_xyz">[docs]</a><span class="k">def</span> <span class="nf">jab_cam16ucs_to_xyz</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span> \
                        <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat16&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for cam16ucs inverse mode with J,aM,bM input and ucstype = &#39;ucs&#39;.</span>
<span class="sd">    </span>
<span class="sd">    | For help on parameter details: ?luxpy.cam.cam16ucs </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cam16ucs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;inverse&#39;</span><span class="p">,</span> <span class="n">ucstype</span> <span class="o">=</span> <span class="s1">&#39;ucs&#39;</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span></div>


<div class="viewcode-block" id="xyz_to_jab_cam16lcd"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.xyz_to_jab_cam16lcd">[docs]</a><span class="k">def</span> <span class="nf">xyz_to_jab_cam16lcd</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span> \
                        <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span>  <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat16&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for cam16ucs forward mode with J,aM,bM output and ucstype = &#39;lcd&#39;.</span>
<span class="sd">    </span>
<span class="sd">    | For help on parameter details: ?luxpy.cam.cam16ucs </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cam16ucs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;forward&#39;</span><span class="p">,</span> <span class="n">ucstype</span> <span class="o">=</span> <span class="s1">&#39;lcd&#39;</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span></div>
                
<div class="viewcode-block" id="jab_cam16lcd_to_xyz"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.jab_cam16lcd_to_xyz">[docs]</a><span class="k">def</span> <span class="nf">jab_cam16lcd_to_xyz</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span> \
                        <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat16&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for cam16ucs inverse mode with J,aM,bM input and ucstype = &#39;lcd&#39;.</span>
<span class="sd">    </span>
<span class="sd">    | For help on parameter details: ?luxpy.cam.cam16ucs </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cam16ucs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;inverse&#39;</span><span class="p">,</span> <span class="n">ucstype</span> <span class="o">=</span> <span class="s1">&#39;lcd&#39;</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span></div>



<div class="viewcode-block" id="xyz_to_jab_cam16scd"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.xyz_to_jab_cam16scd">[docs]</a><span class="k">def</span> <span class="nf">xyz_to_jab_cam16scd</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span> \
                        <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span>  <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat16&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for cam16ucs forward mode with J,aM,bM output and ucstype = &#39;scd&#39;.</span>
<span class="sd">    </span>
<span class="sd">    | For help on parameter details: ?luxpy.cam.cam16ucs </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cam16ucs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;forward&#39;</span><span class="p">,</span> <span class="n">ucstype</span> <span class="o">=</span> <span class="s1">&#39;scd&#39;</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span></div>
                
<div class="viewcode-block" id="jab_cam16scd_to_xyz"><a class="viewcode-back" href="../../../../color.html#luxpy.color.cam.jab_cam16scd_to_xyz">[docs]</a><span class="k">def</span> <span class="nf">jab_cam16scd_to_xyz</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_WHITE_POINT</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span> \
                        <span class="n">conditions</span> <span class="o">=</span> <span class="n">_CAM_02_X_DEFAULT_CONDITIONS</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="s1">&#39;cat16&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for cam16ucs inverse mode with J,aM,bM input  and ucstype = &#39;scd&#39;. </span>
<span class="sd">    </span>
<span class="sd">    | For help on parameter details: ?luxpy.cam.cam16ucs </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cam16ucs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xyzw</span> <span class="o">=</span> <span class="n">xyzw</span><span class="p">,</span> <span class="n">Yw</span> <span class="o">=</span> <span class="n">Yw</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;inverse&#39;</span><span class="p">,</span> <span class="n">ucstype</span> <span class="o">=</span> <span class="s1">&#39;scd&#39;</span><span class="p">,</span> <span class="n">mcat</span> <span class="o">=</span> <span class="n">mcat</span><span class="p">)</span></div>




             
          
        
    
        
        
        
        
        
        
        
               
            
            
            
            
            
            
                
            
        
        
        
        
        
    
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Kevin A.G. Smet.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../',
            VERSION:'1.3.7',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>